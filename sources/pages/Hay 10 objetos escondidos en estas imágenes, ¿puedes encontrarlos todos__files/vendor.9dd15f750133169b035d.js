/*! For license information please see vendor.9dd15f750133169b035d.js.LICENSE.txt?brotli=allow */
(window.subbuzzJsonp=window.subbuzzJsonp||[]).push([[1],Array(22).concat([function(e,t,r){var n;!function(r){var a={};a.EventTarget=function(){"use strict";function e(){this._handlers={}}return e.prototype={constructor:e,on:function(e,t){var r,n,a=this._handlers[e];for(void 0===a&&(a=this._handlers[e]=[]),r=0,n=a.length;r<n;r++)if(a[r]===t)return;a.push(t)},fire:function(e,t){var r,n,a,i={type:e,data:t};if((r=this._handlers[i.type])instanceof Array)for(n=0,a=(r=r.concat()).length;n<a;n++)r[n].call(this,i)},off:function(e,t){var r,n,a=this._handlers[e];if(a instanceof Array)for(r=0,n=a.length;r<n;r++)if(a[r]===t){a.splice(r,1);break}}},e}(),a.NativeDOM=function(){"use strict";return{type:"native",query:function(e,t){return e.querySelector(t)},queryAll:function(e,t){return e.querySelectorAll(t)},on:function(e,t,r){e.addEventListener(t,r,!1)},off:function(e,t,r){e.removeEventListener(t,r,!1)}}}(),a.DOM=a.NativeDOM,a.DOMEventDelegate=function(){"use strict";var e=["click","mouseover","mouseout","mousedown","mouseup","mouseenter","mouseleave","mousemove","keydown","keyup","submit","change","contextmenu","dblclick","input","focusin","focusout"];function t(e){return e&&e.hasAttribute("data-module")}function r(e){return e&&e.hasAttribute("data-type")}function n(e,t,r,n){var a,i;for(a=0;a<e.length;a++)t["on"+(i=e[a])]&&r.call(n,i)}function i(t,r,n){this.element=t,this._handler=r,this._eventTypes=n||e,this._boundHandler={},this._attached=!1}return i.prototype={constructor:i,_handleEvent:function(e){var n=function(e){for(var n=!1,a=!1;!n&&e&&e.parentNode&&!a;)n=r(e),a=t(e),n||(e=e.parentNode);return n?e:null}(e.target),a=n?n.getAttribute("data-type"):"";this._handler["on"+e.type](e,n,a)},attachEvents:function(){this._attached||(n(this._eventTypes,this._handler,(function(e){var t=this;function r(){t._handleEvent.apply(t,arguments)}a.DOM.on(this.element,e,r),this._boundHandler[e]=r}),this),this._attached=!0)},detachEvents:function(){n(this._eventTypes,this._handler,(function(e){a.DOM.off(this.element,e,this._boundHandler[e])}),this)}},i}(),a.Context=function(){"use strict";function e(e,t){this.application=e,this.element=t}return e.prototype={constructor:e,broadcast:function(e,t){this.application.broadcast(e,t)},getService:function(e){return this.application.getService(e)},hasService:function(e){return this.application.hasService(e)},getConfig:function(e){return this.application.getModuleConfig(this.element,e)},getGlobal:function(e){return this.application.getGlobal(e)},getGlobalConfig:function(e){return this.application.getGlobalConfig(e)},reportError:function(e){this.application.reportError(e)},getElement:function(){return this.element}},e}(),a.Application=function(){"use strict";var e={},t={},n=[],i={},o={},s={},u=!1,l=null,f=new a.EventTarget;function c(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function d(t){if("function"!=typeof l){if(e.debug)throw t;f.fire("error",{exception:t})}else l(t)}function h(e,t){"function"==typeof e[t]&&e[t].apply(e,Array.prototype.slice.call(arguments,2))}function v(e){var t,r,n,a,i,s=[],u={};for(r=e.instance.behaviors||[],t=0;t<r.length;t++)i=r[t],"behaviorInstances"in e||(e.behaviorInstances={}),a=e.behaviorInstances,n=o[i],i in u?d(new Error('Behavior "'+i+'" cannot be specified twice in a module.')):n?(a[i]||(a[i]=n.creator(e.context)),s.push(a[i])):d(new Error('Behavior "'+i+'" not found')),u[i]=!0;return s}function p(t,r,n){var i=new a.DOMEventDelegate(r,n,e.eventTypes);t.push(i),i.attachEvents()}function g(e){return s[e.id]}function y(e,t,r){null!==e.onmessage&&"object"==typeof e.onmessage&&e.onmessage.hasOwnProperty(t)?e.onmessage[t].call(e,r):-1!==function(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}(e.messages||[],t)&&e.onmessage.call(e,t,r)}return c(f,{init:function(t){return c(e,t||{}),this.startAll(document.documentElement),this.fire("init"),u=!0,this},destroy:function(){return this.stopAll(document.documentElement),e={},t={},i={},n=[],o={},s={},u=!1,this},isStarted:function(e){return"object"==typeof g(e)},start:function(r){var n,i,o,u=function(e){var t=e.getAttribute("data-module");return t?t.split(" ")[0]:""}(r),l=t[u];if(!l)return d(new Error('Module type "'+u+'" is not defined.')),this;if(!this.isStarted(r)){r.id||(r.id="mod-"+u+"-"+l.counter),l.counter++,i=new a.Context(this,r),o=l.creator(i),e.debug||function(e,t){var r,n;for(r in e)"function"==typeof(n=e[r])&&(e[r]=function(e,r){return function(){var n=t+"."+e+"() - ";try{return r.apply(this,arguments)}catch(r){r.methodName=e,r.objectName=t,r.name=n+r.name,r.message=n+r.message,d(r)}}}(r,n))}(o,u),n={moduleName:u,instance:o,context:i,element:r,eventDelegates:[]},s[r.id]=n;for(var f=v(n),c=0,g=f.length;c<g;c++)h(f[c],"init");h(n.instance,"init"),function(e){var t=e.eventDelegates,r=v(e);p(t,e.element,e.instance);for(var n=0;n<r.length;n++)p(t,e.element,r[n])}(n)}return this},stop:function(t){var r=g(t);if(r){!function(e){for(var t=e.eventDelegates,r=0;r<t.length;r++)t[r].detachEvents();e.eventDelegates=[]}(r);for(var n=v(r),a=n.length-1;a>=0;a--)h(n[a],"destroy");h(r.instance,"destroy"),delete s[t.id]}else if(e.debug)return d(new Error("Unable to stop module associated with element: "+t.id)),this;return this},startAll:function(e){for(var t=a.DOM.queryAll(e,"[data-module]"),r=0,n=t.length;r<n;r++)this.start(t[r]);return this},stopAll:function(e){for(var t=a.DOM.queryAll(e,"[data-module]"),r=0,n=t.length;r<n;r++)this.stop(t[r]);return this},addModule:function(e,r){return void 0!==t[e]?(d(new Error("Module "+e+" has already been added.")),this):(t[e]={creator:r,counter:1},this)},getModuleConfig:function(e,t){var r=g(e),n=null;if(r&&r.config)n=r.config;else{var i=a.DOM.query(e,'script[type="text/x-config"]');if(i)try{n=JSON.parse(i.text)}catch(t){d(new Error("Module with id "+e.id+" has a malformed config."))}r&&(r.config=n)}return n?void 0===t?n:t in n?n[t]:null:null},addService:function(e,t){return void 0!==i[e]?(d(new Error("Service "+e+" has already been added.")),this):(i[e]={creator:t,instance:null},this)},getService:function(e){var t=i[e];if(t){if(!t.instance){if(function(e){for(var t=0,r=n.length;t<r;t++)if(n[t]===e)return!0;return!1}(e))return d(new ReferenceError("Circular service dependency: "+n.join(" -> ")+" -> "+e)),null;n.push(e),t.instance=t.creator(f),n.pop()}return t.instance}return d(new Error('Service "'+e+'" not found')),null},hasService:function(e){return i.hasOwnProperty(e)},addBehavior:function(e,t){return void 0!==o[e]?(d(new Error("Behavior "+e+" has already been added.")),this):(o[e]={creator:t,instance:null},this)},broadcast:function(e,t){var r,n,a,i;for(n in s)if(s.hasOwnProperty(n))for(y((a=s[n]).instance,e,t),i=v(a),r=0;r<i.length;r++)y(i[r],e,t);return this.fire("message",{message:e,messageData:t}),this},getGlobal:function(e){return e in r?r[e]:null},getGlobalConfig:function(t){return void 0===t?e:t in e?e[t]:null},setGlobalConfig:function(t){return u?(d(new Error("Cannot set global configuration after application initialization")),this):(c(e,t),this)},setErrorHandler:function(e){l=e},reportError:d,reportWarning:function(t){if(e.debug){var r=this.getGlobal("console");r&&r.warn&&r.warn(t)}else f.fire("warning",t)},reportInfo:function(t){if(e.debug){var r=this.getGlobal("console");r&&r.info&&r.info(t)}}})}(),void 0===(n=function(){return a}.apply(t,[]))||(e.exports=n)}("undefined"!=typeof window?window:this)},,,,,,,function(e,t,r){var n=r(98);e.exports=function(e,t,r){var a=null==e?void 0:n(e,t);return void 0===a?r:a}},,,,function(e,t){var r=Array.isArray;e.exports=r},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t,r){var n=r(154);e.exports=function(e,t,r){for(var a=r?e:e.parentNode;a&&a!==document;){if(n(a,t))return a;a=a.parentNode}}},function(e,t,r){var n=r(116),a="object"==typeof self&&self&&self.Object===Object&&self,i=n||a||Function("return this")();e.exports=i},,,,,function(e,t,r){"use strict";var n="function"==typeof fetch?fetch:function(e,t){return t=t||{},new Promise((function(r,n){var a=new XMLHttpRequest;for(var i in a.open(t.method||"get",e),t.headers)a.setRequestHeader(i,t.headers[i]);function o(){var e,t=[],r=[],n={};return a.getAllResponseHeaders().replace(/^(.*?):\s*([\s\S]*?)$/gm,(function(a,i,o){t.push(i=i.toLowerCase()),r.push([i,o]),e=n[i],n[i]=e?e+","+o:o})),{ok:1==(a.status/200|0),status:a.status,statusText:a.statusText,url:a.responseURL,clone:o,text:function(){return Promise.resolve(a.responseText)},json:function(){return Promise.resolve(a.responseText).then(JSON.parse)},xml:function(){return Promise.resolve(a.responseXML)},blob:function(){return Promise.resolve(new Blob([a.response]))},headers:{keys:function(){return t},entries:function(){return r},get:function(e){return n[e.toLowerCase()]},has:function(e){return e.toLowerCase()in n}}}}a.withCredentials="include"==t.credentials,a.onload=function(){r(o())},a.onerror=n,a.send(t.body)}))};t.a=n},,function(e,t,r){var n=r(51),a=r(34);e.exports=function(e){if(!a(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},,,function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},,,,function(e,t,r){var n=r(59),a=r(34);e.exports=function(e,t,r){var i=!0,o=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return a(r)&&(i="leading"in r?!!r.leading:i,o="trailing"in r?!!r.trailing:o),n(e,t,{leading:i,maxWait:t,trailing:o})}},function(e,t,r){var n=r(64),a=r(150),i=r(151),o=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":o&&o in Object(e)?a(e):i(e)}},function(e,t,r){var n=r(161),a=r(164);e.exports=function(e,t){var r=a(e,t);return n(r)?r:void 0}},,,,,,,function(e,t,r){var n=r(34),a=r(265),i=r(139),o=Math.max,s=Math.min;e.exports=function(e,t,r){var u,l,f,c,d,h,v=0,p=!1,g=!1,y=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function m(t){var r=u,n=l;return u=l=void 0,v=t,c=e.apply(n,r)}function b(e){return v=e,d=setTimeout(_,t),p?m(e):c}function E(e){var r=e-h;return void 0===h||r>=t||r<0||g&&e-v>=f}function _(){var e=a();if(E(e))return T(e);d=setTimeout(_,function(e){var r=t-(e-h);return g?s(r,f-(e-v)):r}(e))}function T(e){return d=void 0,y&&u?m(e):(u=l=void 0,c)}function A(){var e=a(),r=E(e);if(u=arguments,l=this,h=e,r){if(void 0===d)return b(h);if(g)return d=setTimeout(_,t),m(h)}return void 0===d&&(d=setTimeout(_,t)),c}return t=i(t)||0,n(r)&&(p=!!r.leading,f=(g="maxWait"in r)?o(i(r.maxWait)||0,t):f,y="trailing"in r?!!r.trailing:y),A.cancel=function(){void 0!==d&&clearTimeout(d),v=0,u=h=l=d=void 0},A.flush=function(){return void 0===d?c:T(a())},A}},,,function(e,t,r){var n=r(43),a=r(105);e.exports=function(e){return null!=e&&a(e.length)&&!n(e)}},,function(e,t,r){var n=r(36).Symbol;e.exports=n},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,r){var n=r(80);e.exports=function(e){if("string"==typeof e||n(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},,,,,,function(e,t,r){var n=r(51),a=r(33),i=r(46);e.exports=function(e){return"string"==typeof e||!a(e)&&i(e)&&"[object String]"==n(e)}},,,,,,,function(e,t,r){var n=r(33),a=r(99),i=r(155),o=r(179);e.exports=function(e,t){return n(e)?e:a(e,t)?[e]:i(o(e))}},function(e,t,r){var n=r(51),a=r(46);e.exports=function(e){return"symbol"==typeof e||a(e)&&"[object Symbol]"==n(e)}},function(e,t,r){var n=r(52)(Object,"create");e.exports=n},function(e,t,r){var n=r(169),a=r(170),i=r(171),o=r(172),s=r(173);function u(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}u.prototype.clear=n,u.prototype.delete=a,u.prototype.get=i,u.prototype.has=o,u.prototype.set=s,e.exports=u},function(e,t,r){var n=r(65);e.exports=function(e,t){for(var r=e.length;r--;)if(n(e[r][0],t))return r;return-1}},function(e,t,r){var n=r(175);e.exports=function(e,t){var r=e.__data__;return n(t)?r["string"==typeof t?"string":"hash"]:r.map}},,function(e,t,r){var n=r(195),a=r(46),i=Object.prototype,o=i.hasOwnProperty,s=i.propertyIsEnumerable,u=n(function(){return arguments}())?n:function(e){return a(e)&&o.call(e,"callee")&&!s.call(e,"callee")};e.exports=u},function(e,t){var r=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||r.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t,r){var n=r(127),a=r(238),i=r(62);e.exports=function(e){return i(e)?n(e):a(e)}},,function(e,t,r){var n=r(152);n.Template=r(153).Template,n.template=n.Template,e.exports=n},function(e,t,r){var n=r(181),a=r(207)((function(e,t,r){n(e,t,r)}));e.exports=a},function(e,t,r){var n=r(213),a=r(217)((function(e,t){return null==e?{}:n(e,t)}));e.exports=a},function(e,t,r){var n=r(131);e.exports=function(e,t,r){return null==e?e:n(e,t,r)}},function(e,t,r){var n=r(134),a=r(221),i=r(250),o=r(33),s=r(130);e.exports=function(e,t,r){var u=o(e)?n:i;return r&&s(e,t,r)&&(t=void 0),u(e,a(t,3))}},function(e,t,r){var n=r(254)("jsonp");e.exports=function(e,t,r){"function"==typeof t&&(r=t,t={});t||(t={});var o,s,u=t.prefix||"__jp",l=t.name||u+a++,f=t.param||"callback",c=null!=t.timeout?t.timeout:6e4,d=encodeURIComponent,h=document.getElementsByTagName("script")[0]||document.head;c&&(s=setTimeout((function(){v(),r&&r(new Error("Timeout"))}),c));function v(){o.parentNode&&o.parentNode.removeChild(o),window[l]=i,s&&clearTimeout(s)}return window[l]=function(e){n("jsonp got",e),v(),r&&r(null,e)},e=(e+=(~e.indexOf("?")?"&":"?")+f+"="+d(l)).replace("?&","?"),n('jsonp req "%s"',e),(o=document.createElement("script")).src=e,h.parentNode.insertBefore(o,h),function(){window[l]&&v()}};var a=0;function i(){}},function(e,t,r){var n=r(257),a=r(62),i=r(72),o=r(261),s=r(263),u=Math.max;e.exports=function(e,t,r,l){e=a(e)?e:s(e),r=r&&!l?o(r):0;var f=e.length;return r<0&&(r=u(f+r,0)),i(e)?r<=f&&e.indexOf(t,r)>-1:!!f&&n(e,t,r)>-1}},function(e,t){e.exports=function(e){return null==e}},function(e,t,r){var n=r(79),a=r(66);e.exports=function(e,t){for(var r=0,i=(t=n(t,e)).length;null!=e&&r<i;)e=e[a(t[r++])];return r&&r==i?e:void 0}},function(e,t,r){var n=r(33),a=r(80),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;e.exports=function(e,t){if(n(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!a(e))||(o.test(e)||!i.test(e)||null!=t&&e in Object(t))}},function(e,t,r){var n=r(158),a=r(174),i=r(176),o=r(177),s=r(178);function u(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}u.prototype.clear=n,u.prototype.delete=a,u.prototype.get=i,u.prototype.has=o,u.prototype.set=s,e.exports=u},function(e,t,r){var n=r(52)(r(36),"Map");e.exports=n},function(e,t,r){var n=r(82),a=r(182),i=r(183),o=r(184),s=r(185),u=r(186);function l(e){var t=this.__data__=new n(e);this.size=t.size}l.prototype.clear=a,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=s,l.prototype.set=u,e.exports=l},function(e,t,r){var n=r(120);e.exports=function(e,t,r){"__proto__"==t&&n?n(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}},function(e,t){var r=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}},function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t,r){(function(e){var n=r(36),a=r(197),i=t&&!t.nodeType&&t,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===i?n.Buffer:void 0,u=(s?s.isBuffer:void 0)||a;e.exports=u}).call(this,r(85)(e))},function(e,t,r){var n=r(199),a=r(200),i=r(201),o=i&&i.isTypedArray,s=o?a(o):n;e.exports=s},function(e,t){e.exports=function(e){return e}},,,,,,,,function(e,t,r){(function(t){var r="object"==typeof t&&t&&t.Object===Object&&t;e.exports=r}).call(this,r(61))},function(e,t){var r=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}},function(e,t,r){var n=r(103),a=r(65);e.exports=function(e,t,r){(void 0!==r&&!a(e[t],r)||void 0===r&&!(t in e))&&n(e,t,r)}},function(e,t,r){var n=r(52),a=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=a},function(e,t,r){var n=r(187)();e.exports=n},function(e,t,r){var n=r(36).Uint8Array;e.exports=n},function(e,t,r){var n=r(124)(Object.getPrototypeOf,Object);e.exports=n},function(e,t){e.exports=function(e,t){return function(r){return e(t(r))}}},function(e,t,r){var n=r(103),a=r(65),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,r){var o=e[t];i.call(e,t)&&a(o,r)&&(void 0!==r||t in e)||n(e,t,r)}},function(e,t,r){var n=r(127),a=r(205),i=r(62);e.exports=function(e){return i(e)?n(e,!0):a(e)}},function(e,t,r){var n=r(204),a=r(86),i=r(33),o=r(106),s=r(87),u=r(107),l=Object.prototype.hasOwnProperty;e.exports=function(e,t){var r=i(e),f=!r&&a(e),c=!r&&!f&&o(e),d=!r&&!f&&!c&&u(e),h=r||f||c||d,v=h?n(e.length,String):[],p=v.length;for(var g in e)!t&&!l.call(e,g)||h&&("length"==g||c&&("offset"==g||"parent"==g)||d&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,p))||v.push(g);return v}},function(e,t,r){var n=r(209),a=Math.max;e.exports=function(e,t,r){return t=a(void 0===t?e.length-1:t,0),function(){for(var i=arguments,o=-1,s=a(i.length-t,0),u=Array(s);++o<s;)u[o]=i[t+o];o=-1;for(var l=Array(t+1);++o<t;)l[o]=i[o];return l[t]=r(u),n(e,this,l)}}},function(e,t,r){var n=r(210),a=r(212)(n);e.exports=a},function(e,t,r){var n=r(65),a=r(62),i=r(87),o=r(34);e.exports=function(e,t,r){if(!o(r))return!1;var s=typeof t;return!!("number"==s?a(r)&&i(t,r.length):"string"==s&&t in r)&&n(r[t],e)}},function(e,t,r){var n=r(125),a=r(79),i=r(87),o=r(34),s=r(66);e.exports=function(e,t,r,u){if(!o(e))return e;for(var l=-1,f=(t=a(t,e)).length,c=f-1,d=e;null!=d&&++l<f;){var h=s(t[l]),v=r;if(l!=c){var p=d[h];void 0===(v=u?u(p,h,d):void 0)&&(v=o(p)?p:i(t[l+1])?[]:{})}n(d,h,v),d=d[h]}return e}},function(e,t,r){var n=r(215),a=r(216);e.exports=function(e,t){return null!=e&&a(e,t,n)}},function(e,t){e.exports=function(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}},function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}},function(e,t,r){var n=r(224),a=r(46);e.exports=function e(t,r,i,o,s){return t===r||(null==t||null==r||!a(t)&&!a(r)?t!=t&&r!=r:n(t,r,i,o,e,s))}},function(e,t,r){var n=r(225),a=r(134),i=r(228);e.exports=function(e,t,r,o,s,u){var l=1&r,f=e.length,c=t.length;if(f!=c&&!(l&&c>f))return!1;var d=u.get(e);if(d&&u.get(t))return d==t;var h=-1,v=!0,p=2&r?new n:void 0;for(u.set(e,t),u.set(t,e);++h<f;){var g=e[h],y=t[h];if(o)var m=l?o(y,g,h,t,e,u):o(g,y,h,e,t,u);if(void 0!==m){if(m)continue;v=!1;break}if(p){if(!a(t,(function(e,t){if(!i(p,t)&&(g===e||s(g,e,r,o,u)))return p.push(t)}))){v=!1;break}}else if(g!==y&&!s(g,y,r,o,u)){v=!1;break}}return u.delete(e),u.delete(t),v}},function(e,t,r){var n=r(34);e.exports=function(e){return e==e&&!n(e)}},function(e,t){e.exports=function(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}},function(e,t,r){var n=r(34),a=r(80),i=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,u=/^0o[0-7]+$/i,l=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(a(e))return NaN;if(n(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=n(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var r=s.test(e);return r||u.test(e)?l(e.slice(2),r?2:8):o.test(e)?NaN:+e}},,function(e,t){e.exports=function(){var e,t,r=[],n=Array.prototype.slice.call(arguments),a=n.length,i=0;if(!a)throw new Error("zip requires at least one argument");for(e=0;e<a;e++){if(!Array.isArray(n[e]))throw new Error("all arguments must be arrays");var o=n[e].length;o>i&&(i=o)}for(e=0;e<i;e++){var s=[];for(t=0;t<a;t++){if(!Array.isArray(n[t]))throw new Error("all arguments must be arrays");s[t]=n[t][e]}r[e]=s}return r}},,,,,,,,,function(e,t,r){var n=r(64),a=Object.prototype,i=a.hasOwnProperty,o=a.toString,s=n?n.toStringTag:void 0;e.exports=function(e){var t=i.call(e,s),r=e[s];try{e[s]=void 0;var n=!0}catch(e){}var a=o.call(e);return n&&(t?e[s]=r:delete e[s]),a}},function(e,t){var r=Object.prototype.toString;e.exports=function(e){return r.call(e)}},function(e,t,r){!function(e){var t=/\S/,r=/\"/g,n=/\n/g,a=/\r/g,i=/\\/g,o=/\u2028/,s=/\u2029/;function u(e){"}"===e.n.substr(e.n.length-1)&&(e.n=e.n.substring(0,e.n.length-1))}function l(e){return e.trim?e.trim():e.replace(/^\s*|\s*$/g,"")}function f(e,t,r){if(t.charAt(r)!=e.charAt(0))return!1;for(var n=1,a=e.length;n<a;n++)if(t.charAt(r+n)!=e.charAt(n))return!1;return!0}e.tags={"#":1,"^":2,"<":3,$:4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12},e.scan=function(r,n){var a=r.length,i=0,o=null,s=null,c="",d=[],h=!1,v=0,p=0,g="{{",y="}}";function m(){c.length>0&&(d.push({tag:"_t",text:new String(c)}),c="")}function b(r,n){if(m(),r&&function(){for(var r=!0,n=p;n<d.length;n++)if(!(r=e.tags[d[n].tag]<e.tags._v||"_t"==d[n].tag&&null===d[n].text.match(t)))return!1;return r}())for(var a,i=p;i<d.length;i++)d[i].text&&((a=d[i+1])&&">"==a.tag&&(a.indent=d[i].text.toString()),d.splice(i,1));else n||d.push({tag:"\n"});h=!1,p=d.length}function E(e,t){var r="="+y,n=e.indexOf(r,t),a=l(e.substring(e.indexOf("=",t)+1,n)).split(" ");return g=a[0],y=a[a.length-1],n+r.length-1}for(n&&(n=n.split(" "),g=n[0],y=n[1]),v=0;v<a;v++)0==i?f(g,r,v)?(--v,m(),i=1):"\n"==r.charAt(v)?b(h):c+=r.charAt(v):1==i?(v+=g.length-1,"="==(o=(s=e.tags[r.charAt(v+1)])?r.charAt(v+1):"_v")?(v=E(r,v),i=0):(s&&v++,i=2),h=v):f(y,r,v)?(d.push({tag:o,n:l(c),otag:g,ctag:y,i:"/"==o?h-g.length:v+y.length}),c="",v+=y.length-1,i=0,"{"==o&&("}}"==y?v++:u(d[d.length-1]))):c+=r.charAt(v);return b(h,!0),d};var c={_t:!0,"\n":!0,$:!0,"/":!0};function d(e,t){for(var r=0,n=t.length;r<n;r++)if(t[r].o==e.n)return e.tag="#",!0}function h(e,t,r){for(var n=0,a=r.length;n<a;n++)if(r[n].c==e&&r[n].o==t)return!0}function v(e){var t=[];for(var r in e.partials)t.push('"'+g(r)+'":{name:"'+g(e.partials[r].name)+'", '+v(e.partials[r])+"}");return"partials: {"+t.join(",")+"}, subs: "+function(e){var t=[];for(var r in e)t.push('"'+g(r)+'": function(c,p,t,i) {'+e[r]+"}");return"{ "+t.join(",")+" }"}(e.subs)}e.stringify=function(t,r,n){return"{code: function (c,p,i) { "+e.wrapMain(t.code)+" },"+v(t)+"}"};var p=0;function g(e){return e.replace(i,"\\\\").replace(r,'\\"').replace(n,"\\n").replace(a,"\\r").replace(o,"\\u2028").replace(s,"\\u2029")}function y(e){return~e.indexOf(".")?"d":"f"}function m(e,t){var r="<"+(t.prefix||"")+e.n+p++;return t.partials[r]={name:e.n,partials:{}},t.code+='t.b(t.rp("'+g(r)+'",c,p,"'+(e.indent||"")+'"));',r}function b(e,t){t.code+="t.b(t.t(t."+y(e.n)+'("'+g(e.n)+'",c,p,0)));'}function E(e){return"t.b("+e+");"}e.generate=function(t,r,n){p=0;var a={code:"",subs:{},partials:{}};return e.walk(t,a),n.asString?this.stringify(a,r,n):this.makeTemplate(a,r,n)},e.wrapMain=function(e){return'var t=this;t.b(i=i||"");'+e+"return t.fl();"},e.template=e.Template,e.makeTemplate=function(e,t,r){var n=this.makePartials(e);return n.code=new Function("c","p","i",this.wrapMain(e.code)),new this.template(n,t,this,r)},e.makePartials=function(e){var t,r={subs:{},partials:e.partials,name:e.name};for(t in r.partials)r.partials[t]=this.makePartials(r.partials[t]);for(t in e.subs)r.subs[t]=new Function("c","p","t","i",e.subs[t]);return r},e.codegen={"#":function(t,r){r.code+="if(t.s(t."+y(t.n)+'("'+g(t.n)+'",c,p,1),c,p,0,'+t.i+","+t.end+',"'+t.otag+" "+t.ctag+'")){t.rs(c,p,function(c,p,t){',e.walk(t.nodes,r),r.code+="});c.pop();}"},"^":function(t,r){r.code+="if(!t.s(t."+y(t.n)+'("'+g(t.n)+'",c,p,1),c,p,1,0,0,"")){',e.walk(t.nodes,r),r.code+="};"},">":m,"<":function(t,r){var n={partials:{},code:"",subs:{},inPartial:!0};e.walk(t.nodes,n);var a=r.partials[m(t,r)];a.subs=n.subs,a.partials=n.partials},$:function(t,r){var n={subs:{},code:"",partials:r.partials,prefix:t.n};e.walk(t.nodes,n),r.subs[t.n]=n.code,r.inPartial||(r.code+='t.sub("'+g(t.n)+'",c,p,i);')},"\n":function(e,t){t.code+=E('"\\n"'+(e.last?"":" + i"))},_v:function(e,t){t.code+="t.b(t.v(t."+y(e.n)+'("'+g(e.n)+'",c,p,0)));'},_t:function(e,t){t.code+=E('"'+g(e.text)+'"')},"{":b,"&":b},e.walk=function(t,r){for(var n,a=0,i=t.length;a<i;a++)(n=e.codegen[t[a].tag])&&n(t[a],r);return r},e.parse=function(t,r,n){return function t(r,n,a,i){var o,s=[],u=null,l=null;for(o=a[a.length-1];r.length>0;){if(l=r.shift(),o&&"<"==o.tag&&!(l.tag in c))throw new Error("Illegal content in < super tag.");if(e.tags[l.tag]<=e.tags.$||d(l,i))a.push(l),l.nodes=t(r,l.tag,a,i);else{if("/"==l.tag){if(0===a.length)throw new Error("Closing tag without opener: /"+l.n);if(u=a.pop(),l.n!=u.n&&!h(l.n,u.n,i))throw new Error("Nesting error: "+u.n+" vs. "+l.n);return u.end=l.i,s}"\n"==l.tag&&(l.last=0==r.length||"\n"==r[0].tag)}s.push(l)}if(a.length>0)throw new Error("missing closing tag: "+a.pop().n);return s}(t,0,[],(n=n||{}).sectionTags||[])},e.cache={},e.cacheKey=function(e,t){return[e,!!t.asString,!!t.disableLambda,t.delimiters,!!t.modelGet].join("||")},e.compile=function(t,r){r=r||{};var n=e.cacheKey(t,r),a=this.cache[n];if(a){var i=a.partials;for(var o in i)delete i[o].instance;return a}return a=this.generate(this.parse(this.scan(t,r.delimiters),t,r),t,r),this.cache[n]=a}}(t)},function(e,t,r){!function(e){function t(e,t,r){var n;return t&&"object"==typeof t&&(void 0!==t[e]?n=t[e]:r&&t.get&&"function"==typeof t.get&&(n=t.get(e))),n}e.Template=function(e,t,r,n){e=e||{},this.r=e.code||this.r,this.c=r,this.options=n||{},this.text=t||"",this.partials=e.partials||{},this.subs=e.subs||{},this.buf=""},e.Template.prototype={r:function(e,t,r){return""},v:function(e){return e=u(e),s.test(e)?e.replace(r,"&amp;").replace(n,"&lt;").replace(a,"&gt;").replace(i,"&#39;").replace(o,"&quot;"):e},t:u,render:function(e,t,r){return this.ri([e],t||{},r)},ri:function(e,t,r){return this.r(e,t,r)},ep:function(e,t){var r=this.partials[e],n=t[r.name];if(r.instance&&r.base==n)return r.instance;if("string"==typeof n){if(!this.c)throw new Error("No compiler available.");n=this.c.compile(n,this.options)}if(!n)return null;if(this.partials[e].base=n,r.subs){for(key in t.stackText||(t.stackText={}),r.subs)t.stackText[key]||(t.stackText[key]=void 0!==this.activeSub&&t.stackText[this.activeSub]?t.stackText[this.activeSub]:this.text);n=function(e,t,r,n,a,i){function o(){}function s(){}var u;o.prototype=e,s.prototype=e.subs;var l=new o;for(u in l.subs=new s,l.subsText={},l.buf="",n=n||{},l.stackSubs=n,l.subsText=i,t)n[u]||(n[u]=t[u]);for(u in n)l.subs[u]=n[u];for(u in a=a||{},l.stackPartials=a,r)a[u]||(a[u]=r[u]);for(u in a)l.partials[u]=a[u];return l}(n,r.subs,r.partials,this.stackSubs,this.stackPartials,t.stackText)}return this.partials[e].instance=n,n},rp:function(e,t,r,n){var a=this.ep(e,r);return a?a.ri(t,r,n):""},rs:function(e,t,r){var n=e[e.length-1];if(l(n))for(var a=0;a<n.length;a++)e.push(n[a]),r(e,t,this),e.pop();else r(e,t,this)},s:function(e,t,r,n,a,i,o){var s;return(!l(e)||0!==e.length)&&("function"==typeof e&&(e=this.ms(e,t,r,n,a,i,o)),s=!!e,!n&&s&&t&&t.push("object"==typeof e?e:t[t.length-1]),s)},d:function(e,r,n,a){var i,o=e.split("."),s=this.f(o[0],r,n,a),u=this.options.modelGet,f=null;if("."===e&&l(r[r.length-2]))s=r[r.length-1];else for(var c=1;c<o.length;c++)void 0!==(i=t(o[c],s,u))?(f=s,s=i):s="";return!(a&&!s)&&(a||"function"!=typeof s||(r.push(f),s=this.mv(s,r,n),r.pop()),s)},f:function(e,r,n,a){for(var i=!1,o=!1,s=this.options.modelGet,u=r.length-1;u>=0;u--)if(void 0!==(i=t(e,r[u],s))){o=!0;break}return o?(a||"function"!=typeof i||(i=this.mv(i,r,n)),i):!a&&""},ls:function(e,t,r,n,a){var i=this.options.delimiters;return this.options.delimiters=a,this.b(this.ct(u(e.call(t,n)),t,r)),this.options.delimiters=i,!1},ct:function(e,t,r){if(this.options.disableLambda)throw new Error("Lambda features disabled.");return this.c.compile(e,this.options).render(t,r)},b:function(e){this.buf+=e},fl:function(){var e=this.buf;return this.buf="",e},ms:function(e,t,r,n,a,i,o){var s,u=t[t.length-1],l=e.call(u);return"function"==typeof l?!!n||(s=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(l,u,r,s.substring(a,i),o)):l},mv:function(e,t,r){var n=t[t.length-1],a=e.call(n);return"function"==typeof a?this.ct(u(a.call(n)),n,r):a},sub:function(e,t,r,n){var a=this.subs[e];a&&(this.activeSub=e,a(t,r,this,n),this.activeSub=!1)}};var r=/&/g,n=/</g,a=/>/g,i=/\'/g,o=/\"/g,s=/[&<>\"\']/;function u(e){return String(null==e?"":e)}var l=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}}(t)},function(e,t){var r=Element.prototype,n=r.matchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector;e.exports=function(e,t){if(n)return n.call(e,t);for(var r=e.parentNode.querySelectorAll(t),a=0;a<r.length;++a)if(r[a]==e)return!0;return!1}},function(e,t,r){var n=r(156),a=/^\./,i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,s=n((function(e){var t=[];return a.test(e)&&t.push(""),e.replace(i,(function(e,r,n,a){t.push(n?a.replace(o,"$1"):r||e)})),t}));e.exports=s},function(e,t,r){var n=r(157);e.exports=function(e){var t=n(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}},function(e,t,r){var n=r(100);function a(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var o=e.apply(this,n);return r.cache=i.set(a,o)||i,o};return r.cache=new(a.Cache||n),r}a.Cache=n,e.exports=a},function(e,t,r){var n=r(159),a=r(82),i=r(101);e.exports=function(){this.size=0,this.__data__={hash:new n,map:new(i||a),string:new n}}},function(e,t,r){var n=r(160),a=r(165),i=r(166),o=r(167),s=r(168);function u(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}u.prototype.clear=n,u.prototype.delete=a,u.prototype.get=i,u.prototype.has=o,u.prototype.set=s,e.exports=u},function(e,t,r){var n=r(81);e.exports=function(){this.__data__=n?n(null):{},this.size=0}},function(e,t,r){var n=r(43),a=r(162),i=r(34),o=r(117),s=/^\[object .+?Constructor\]$/,u=Function.prototype,l=Object.prototype,f=u.toString,c=l.hasOwnProperty,d=RegExp("^"+f.call(c).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||a(e))&&(n(e)?d:s).test(o(e))}},function(e,t,r){var n,a=r(163),i=(n=/[^.]+$/.exec(a&&a.keys&&a.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";e.exports=function(e){return!!i&&i in e}},function(e,t,r){var n=r(36)["__core-js_shared__"];e.exports=n},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,r){var n=r(81),a=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(n){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return a.call(t,e)?t[e]:void 0}},function(e,t,r){var n=r(81),a=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return n?void 0!==t[e]:a.call(t,e)}},function(e,t,r){var n=r(81);e.exports=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=n&&void 0===t?"__lodash_hash_undefined__":t,this}},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,r){var n=r(83),a=Array.prototype.splice;e.exports=function(e){var t=this.__data__,r=n(t,e);return!(r<0)&&(r==t.length-1?t.pop():a.call(t,r,1),--this.size,!0)}},function(e,t,r){var n=r(83);e.exports=function(e){var t=this.__data__,r=n(t,e);return r<0?void 0:t[r][1]}},function(e,t,r){var n=r(83);e.exports=function(e){return n(this.__data__,e)>-1}},function(e,t,r){var n=r(83);e.exports=function(e,t){var r=this.__data__,a=n(r,e);return a<0?(++this.size,r.push([e,t])):r[a][1]=t,this}},function(e,t,r){var n=r(84);e.exports=function(e){var t=n(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,r){var n=r(84);e.exports=function(e){return n(this,e).get(e)}},function(e,t,r){var n=r(84);e.exports=function(e){return n(this,e).has(e)}},function(e,t,r){var n=r(84);e.exports=function(e,t){var r=n(this,e),a=r.size;return r.set(e,t),this.size+=r.size==a?0:1,this}},function(e,t,r){var n=r(180);e.exports=function(e){return null==e?"":n(e)}},function(e,t,r){var n=r(64),a=r(118),i=r(33),o=r(80),s=n?n.prototype:void 0,u=s?s.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(i(t))return a(t,e)+"";if(o(t))return u?u.call(t):"";var r=t+"";return"0"==r&&1/t==-1/0?"-0":r}},function(e,t,r){var n=r(102),a=r(119),i=r(121),o=r(188),s=r(34),u=r(126);e.exports=function e(t,r,l,f,c){t!==r&&i(r,(function(i,u){if(s(i))c||(c=new n),o(t,r,u,l,e,f,c);else{var d=f?f(t[u],i,u+"",t,r,c):void 0;void 0===d&&(d=i),a(t,u,d)}}),u)}},function(e,t,r){var n=r(82);e.exports=function(){this.__data__=new n,this.size=0}},function(e,t){e.exports=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}},function(e,t){e.exports=function(e){return this.__data__.get(e)}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t,r){var n=r(82),a=r(101),i=r(100);e.exports=function(e,t){var r=this.__data__;if(r instanceof n){var o=r.__data__;if(!a||o.length<199)return o.push([e,t]),this.size=++r.size,this;r=this.__data__=new i(o)}return r.set(e,t),this.size=r.size,this}},function(e,t){e.exports=function(e){return function(t,r,n){for(var a=-1,i=Object(t),o=n(t),s=o.length;s--;){var u=o[e?s:++a];if(!1===r(i[u],u,i))break}return t}}},function(e,t,r){var n=r(119),a=r(189),i=r(190),o=r(192),s=r(193),u=r(86),l=r(33),f=r(196),c=r(106),d=r(43),h=r(34),v=r(198),p=r(107),g=r(202);e.exports=function(e,t,r,y,m,b,E){var _=e[r],T=t[r],A=E.get(T);if(A)n(e,r,A);else{var S=b?b(_,T,r+"",e,t,E):void 0,k=void 0===S;if(k){var w=l(T),R=!w&&c(T),L=!w&&!R&&p(T);S=T,w||R||L?l(_)?S=_:f(_)?S=o(_):R?(k=!1,S=a(T,!0)):L?(k=!1,S=i(T,!0)):S=[]:v(T)||u(T)?(S=_,u(_)?S=g(_):(!h(_)||y&&d(_))&&(S=s(T))):k=!1}k&&(E.set(T,S),m(S,T,y,b,E),E.delete(T)),n(e,r,S)}}},function(e,t,r){(function(e){var n=r(36),a=t&&!t.nodeType&&t,i=a&&"object"==typeof e&&e&&!e.nodeType&&e,o=i&&i.exports===a?n.Buffer:void 0,s=o?o.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=s?s(r):new e.constructor(r);return e.copy(n),n}}).call(this,r(85)(e))},function(e,t,r){var n=r(191);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}},function(e,t,r){var n=r(122);e.exports=function(e){var t=new e.constructor(e.byteLength);return new n(t).set(new n(e)),t}},function(e,t){e.exports=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}},function(e,t,r){var n=r(194),a=r(123),i=r(104);e.exports=function(e){return"function"!=typeof e.constructor||i(e)?{}:n(a(e))}},function(e,t,r){var n=r(34),a=Object.create,i=function(){function e(){}return function(t){if(!n(t))return{};if(a)return a(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();e.exports=i},function(e,t,r){var n=r(51),a=r(46);e.exports=function(e){return a(e)&&"[object Arguments]"==n(e)}},function(e,t,r){var n=r(62),a=r(46);e.exports=function(e){return a(e)&&n(e)}},function(e,t){e.exports=function(){return!1}},function(e,t,r){var n=r(51),a=r(123),i=r(46),o=Function.prototype,s=Object.prototype,u=o.toString,l=s.hasOwnProperty,f=u.call(Object);e.exports=function(e){if(!i(e)||"[object Object]"!=n(e))return!1;var t=a(e);if(null===t)return!0;var r=l.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&u.call(r)==f}},function(e,t,r){var n=r(51),a=r(105),i=r(46),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&a(e.length)&&!!o[n(e)]}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,r){(function(e){var n=r(116),a=t&&!t.nodeType&&t,i=a&&"object"==typeof e&&e&&!e.nodeType&&e,o=i&&i.exports===a&&n.process,s=function(){try{return o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=s}).call(this,r(85)(e))},function(e,t,r){var n=r(203),a=r(126);e.exports=function(e){return n(e,a(e))}},function(e,t,r){var n=r(125),a=r(103);e.exports=function(e,t,r,i){var o=!r;r||(r={});for(var s=-1,u=t.length;++s<u;){var l=t[s],f=i?i(r[l],e[l],l,r,e):void 0;void 0===f&&(f=e[l]),o?a(r,l,f):n(r,l,f)}return r}},function(e,t){e.exports=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},function(e,t,r){var n=r(34),a=r(104),i=r(206),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return i(e);var t=a(e),r=[];for(var s in e)("constructor"!=s||!t&&o.call(e,s))&&r.push(s);return r}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}},function(e,t,r){var n=r(208),a=r(130);e.exports=function(e){return n((function(t,r){var n=-1,i=r.length,o=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,s&&a(r[0],r[1],s)&&(o=i<3?void 0:o,i=1),t=Object(t);++n<i;){var u=r[n];u&&e(t,u,n,o)}return t}))}},function(e,t,r){var n=r(108),a=r(128),i=r(129);e.exports=function(e,t){return i(a(e,t,n),e+"")}},function(e,t){e.exports=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}},function(e,t,r){var n=r(211),a=r(120),i=r(108),o=a?function(e,t){return a(e,"toString",{configurable:!0,enumerable:!1,value:n(t),writable:!0})}:i;e.exports=o},function(e,t){e.exports=function(e){return function(){return e}}},function(e,t){var r=Date.now;e.exports=function(e){var t=0,n=0;return function(){var a=r(),i=16-(a-n);if(n=a,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},function(e,t,r){var n=r(214),a=r(132);e.exports=function(e,t){return n(e,t,(function(t,r){return a(e,r)}))}},function(e,t,r){var n=r(98),a=r(131),i=r(79);e.exports=function(e,t,r){for(var o=-1,s=t.length,u={};++o<s;){var l=t[o],f=n(e,l);r(f,l)&&a(u,i(l,e),f)}return u}},function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},function(e,t,r){var n=r(79),a=r(86),i=r(33),o=r(87),s=r(105),u=r(66);e.exports=function(e,t,r){for(var l=-1,f=(t=n(t,e)).length,c=!1;++l<f;){var d=u(t[l]);if(!(c=null!=e&&r(e,d)))break;e=e[d]}return c||++l!=f?c:!!(f=null==e?0:e.length)&&s(f)&&o(d,f)&&(i(e)||a(e))}},function(e,t,r){var n=r(218),a=r(128),i=r(129);e.exports=function(e){return i(a(e,void 0,n),e+"")}},function(e,t,r){var n=r(219);e.exports=function(e){return(null==e?0:e.length)?n(e,1):[]}},function(e,t,r){var n=r(133),a=r(220);e.exports=function e(t,r,i,o,s){var u=-1,l=t.length;for(i||(i=a),s||(s=[]);++u<l;){var f=t[u];r>0&&i(f)?r>1?e(f,r-1,i,o,s):n(s,f):o||(s[s.length]=f)}return s}},function(e,t,r){var n=r(64),a=r(86),i=r(33),o=n?n.isConcatSpreadable:void 0;e.exports=function(e){return i(e)||a(e)||!!(o&&e&&e[o])}},function(e,t,r){var n=r(222),a=r(246),i=r(108),o=r(33),s=r(247);e.exports=function(e){return"function"==typeof e?e:null==e?i:"object"==typeof e?o(e)?a(e[0],e[1]):n(e):s(e)}},function(e,t,r){var n=r(223),a=r(245),i=r(138);e.exports=function(e){var t=a(e);return 1==t.length&&t[0][2]?i(t[0][0],t[0][1]):function(r){return r===e||n(r,e,t)}}},function(e,t,r){var n=r(102),a=r(135);e.exports=function(e,t,r,i){var o=r.length,s=o,u=!i;if(null==e)return!s;for(e=Object(e);o--;){var l=r[o];if(u&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++o<s;){var f=(l=r[o])[0],c=e[f],d=l[1];if(u&&l[2]){if(void 0===c&&!(f in e))return!1}else{var h=new n;if(i)var v=i(c,d,f,e,t,h);if(!(void 0===v?a(d,c,3,i,h):v))return!1}}return!0}},function(e,t,r){var n=r(102),a=r(136),i=r(229),o=r(232),s=r(240),u=r(33),l=r(106),f=r(107),c="[object Object]",d=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,h,v,p){var g=u(e),y=u(t),m=g?"[object Array]":s(e),b=y?"[object Array]":s(t),E=(m="[object Arguments]"==m?c:m)==c,_=(b="[object Arguments]"==b?c:b)==c,T=m==b;if(T&&l(e)){if(!l(t))return!1;g=!0,E=!1}if(T&&!E)return p||(p=new n),g||f(e)?a(e,t,r,h,v,p):i(e,t,m,r,h,v,p);if(!(1&r)){var A=E&&d.call(e,"__wrapped__"),S=_&&d.call(t,"__wrapped__");if(A||S){var k=A?e.value():e,w=S?t.value():t;return p||(p=new n),v(k,w,r,h,p)}}return!!T&&(p||(p=new n),o(e,t,r,h,v,p))}},function(e,t,r){var n=r(100),a=r(226),i=r(227);function o(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new n;++t<r;)this.add(e[t])}o.prototype.add=o.prototype.push=a,o.prototype.has=i,e.exports=o},function(e,t){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t){e.exports=function(e,t){return e.has(t)}},function(e,t,r){var n=r(64),a=r(122),i=r(65),o=r(136),s=r(230),u=r(231),l=n?n.prototype:void 0,f=l?l.valueOf:void 0;e.exports=function(e,t,r,n,l,c,d){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!c(new a(e),new a(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return i(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var h=s;case"[object Set]":var v=1&n;if(h||(h=u),e.size!=t.size&&!v)return!1;var p=d.get(e);if(p)return p==t;n|=2,d.set(e,t);var g=o(h(e),h(t),n,l,c,d);return d.delete(e),g;case"[object Symbol]":if(f)return f.call(e)==f.call(t)}return!1}},function(e,t){e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}},function(e,t){e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}},function(e,t,r){var n=r(233),a=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,i,o,s){var u=1&r,l=n(e),f=l.length;if(f!=n(t).length&&!u)return!1;for(var c=f;c--;){var d=l[c];if(!(u?d in t:a.call(t,d)))return!1}var h=s.get(e);if(h&&s.get(t))return h==t;var v=!0;s.set(e,t),s.set(t,e);for(var p=u;++c<f;){var g=e[d=l[c]],y=t[d];if(i)var m=u?i(y,g,d,t,e,s):i(g,y,d,e,t,s);if(!(void 0===m?g===y||o(g,y,r,i,s):m)){v=!1;break}p||(p="constructor"==d)}if(v&&!p){var b=e.constructor,E=t.constructor;b==E||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof E&&E instanceof E||(v=!1)}return s.delete(e),s.delete(t),v}},function(e,t,r){var n=r(234),a=r(235),i=r(88);e.exports=function(e){return n(e,i,a)}},function(e,t,r){var n=r(133),a=r(33);e.exports=function(e,t,r){var i=t(e);return a(e)?i:n(i,r(e))}},function(e,t,r){var n=r(236),a=r(237),i=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,s=o?function(e){return null==e?[]:(e=Object(e),n(o(e),(function(t){return i.call(e,t)})))}:a;e.exports=s},function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,a=0,i=[];++r<n;){var o=e[r];t(o,r,e)&&(i[a++]=o)}return i}},function(e,t){e.exports=function(){return[]}},function(e,t,r){var n=r(104),a=r(239),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return a(e);var t=[];for(var r in Object(e))i.call(e,r)&&"constructor"!=r&&t.push(r);return t}},function(e,t,r){var n=r(124)(Object.keys,Object);e.exports=n},function(e,t,r){var n=r(241),a=r(101),i=r(242),o=r(243),s=r(244),u=r(51),l=r(117),f=l(n),c=l(a),d=l(i),h=l(o),v=l(s),p=u;(n&&"[object DataView]"!=p(new n(new ArrayBuffer(1)))||a&&"[object Map]"!=p(new a)||i&&"[object Promise]"!=p(i.resolve())||o&&"[object Set]"!=p(new o)||s&&"[object WeakMap]"!=p(new s))&&(p=function(e){var t=u(e),r="[object Object]"==t?e.constructor:void 0,n=r?l(r):"";if(n)switch(n){case f:return"[object DataView]";case c:return"[object Map]";case d:return"[object Promise]";case h:return"[object Set]";case v:return"[object WeakMap]"}return t}),e.exports=p},function(e,t,r){var n=r(52)(r(36),"DataView");e.exports=n},function(e,t,r){var n=r(52)(r(36),"Promise");e.exports=n},function(e,t,r){var n=r(52)(r(36),"Set");e.exports=n},function(e,t,r){var n=r(52)(r(36),"WeakMap");e.exports=n},function(e,t,r){var n=r(137),a=r(88);e.exports=function(e){for(var t=a(e),r=t.length;r--;){var i=t[r],o=e[i];t[r]=[i,o,n(o)]}return t}},function(e,t,r){var n=r(135),a=r(29),i=r(132),o=r(99),s=r(137),u=r(138),l=r(66);e.exports=function(e,t){return o(e)&&s(t)?u(l(e),t):function(r){var o=a(r,e);return void 0===o&&o===t?i(r,e):n(t,o,3)}}},function(e,t,r){var n=r(248),a=r(249),i=r(99),o=r(66);e.exports=function(e){return i(e)?n(o(e)):a(e)}},function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},function(e,t,r){var n=r(98);e.exports=function(e){return function(t){return n(t,e)}}},function(e,t,r){var n=r(251);e.exports=function(e,t){var r;return n(e,(function(e,n,a){return!(r=t(e,n,a))})),!!r}},function(e,t,r){var n=r(252),a=r(253)(n);e.exports=a},function(e,t,r){var n=r(121),a=r(88);e.exports=function(e,t){return e&&n(e,t,a)}},function(e,t,r){var n=r(62);e.exports=function(e,t){return function(r,a){if(null==r)return r;if(!n(r))return e(r,a);for(var i=r.length,o=t?i:-1,s=Object(r);(t?o--:++o<i)&&!1!==a(s[o],o,s););return r}}},function(e,t,r){(function(n){function a(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==n&&"env"in n&&(e=n.env.DEBUG),e}(t=e.exports=r(255)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),!r)return;var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var a=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(a++,"%c"===e&&(i=a))})),e.splice(i,0,n)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=a,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(a())}).call(this,r(89))},function(e,t,r){var n;function a(e){function r(){if(r.enabled){var e=r,a=+new Date,i=a-(n||a);e.diff=i,e.prev=n,e.curr=a,n=a;for(var o=new Array(arguments.length),s=0;s<o.length;s++)o[s]=arguments[s];o[0]=t.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var u=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,(function(r,n){if("%%"===r)return r;u++;var a=t.formatters[n];if("function"==typeof a){var i=o[u];r=a.call(e,i),o.splice(u,1),u--}return r})),t.formatArgs.call(e,o);var l=r.log||t.log||console.log.bind(console);l.apply(e,o)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),"function"==typeof t.init&&t.init(r),r}(t=e.exports=a.debug=a.default=a).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var r=("string"==typeof e?e:"").split(/[\s,]+/),n=r.length,a=0;a<n;a++)r[a]&&("-"===(e=r[a].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(256),t.names=[],t.skips=[],t.formatters={}},function(e,t){var r=1e3,n=6e4,a=60*n,i=24*a;function o(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}e.exports=function(e,t){t=t||{};var s,u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var o=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"days":case"day":case"d":return o*i;case"hours":case"hour":case"hrs":case"hr":case"h":return o*a;case"minutes":case"minute":case"mins":case"min":case"m":return o*n;case"seconds":case"second":case"secs":case"sec":case"s":return o*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}(e);if("number"===u&&!1===isNaN(e))return t.long?o(s=e,i,"day")||o(s,a,"hour")||o(s,n,"minute")||o(s,r,"second")||s+" ms":function(e){if(e>=i)return Math.round(e/i)+"d";if(e>=a)return Math.round(e/a)+"h";if(e>=n)return Math.round(e/n)+"m";if(e>=r)return Math.round(e/r)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,r){var n=r(258),a=r(259),i=r(260);e.exports=function(e,t,r){return t==t?i(e,t,r):n(e,a,r)}},function(e,t){e.exports=function(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1}},function(e,t){e.exports=function(e){return e!=e}},function(e,t){e.exports=function(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}},function(e,t,r){var n=r(262);e.exports=function(e){var t=n(e),r=t%1;return t==t?r?t-r:t:0}},function(e,t,r){var n=r(139);e.exports=function(e){return e?(e=n(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},function(e,t,r){var n=r(264),a=r(88);e.exports=function(e){return null==e?[]:n(e,a(e))}},function(e,t,r){var n=r(118);e.exports=function(e,t){return n(t,(function(t){return e[t]}))}},function(e,t,r){var n=r(36);e.exports=function(){return n.Date.now()}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){e.exports=function e(t,r,n){function a(o,s){if(!r[o]){if(!t[o]){if(i)return i(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[o]={exports:{}};t[o][0].call(l.exports,(function(e){var r=t[o][1][e];return a(r||e)}),l,l.exports,e,t,r,n)}return r[o].exports}for(var i=!1,o=0;o<n.length;o++)a(n[o]);return a}({1:[function(e,t,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function a(e){return"function"==typeof e}function i(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,r,n,s,u,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var f=new Error('Uncaught, unspecified "error" event. ('+t+")");throw f.context=t,f}if(o(r=this._events[e]))return!1;if(a(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),r.apply(this,s)}else if(i(r))for(s=Array.prototype.slice.call(arguments,1),n=(l=r.slice()).length,u=0;u<n;u++)l[u].apply(this,s);return!0},n.prototype.addListener=function(e,t){var r;if(!a(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,a(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(r=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){if(!a(t))throw TypeError("listener must be a function");var r=!1;function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var r,n,o,s;if(!a(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(o=(r=this._events[e]).length,n=-1,r===t||a(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(r)){for(s=o;s-- >0;)if(r[s]===t||r[s].listener&&r[s].listener===t){n=s;break}if(n<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(a(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?a(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(a(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},{}],2:[function(e,t,r){var n,a,i,o,s,u;n=this,a=/^((?:[^\/;?#]+:)?)(\/\/[^\/\;?#]*)?(.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,i=/^([^\/;?#]*)(.*)$/,o=/(?:\/|^)\.(?=\/)/g,s=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,u={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var n=this.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");return n.path=u.normalizePath(n.path),u.buildURLFromParts(n)}var a=this.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return r.alwaysNormalize?(a.path=u.normalizePath(a.path),u.buildURLFromParts(a)):t;var o=this.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var s=i.exec(o.path);o.netLoc=s[1],o.path=s[2]}o.netLoc&&!o.path&&(o.path="/");var l={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(l.netLoc=o.netLoc,"/"!==a.path[0]))if(a.path){var f=o.path,c=f.substring(0,f.lastIndexOf("/")+1)+a.path;l.path=u.normalizePath(c)}else l.path=o.path,a.params||(l.params=o.params,a.query||(l.query=o.query));return null===l.path&&(l.path=r.alwaysNormalize?u.normalizePath(a.path):a.path),u.buildURLFromParts(l)},parseURL:function(e){var t=a.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(o,"");e.length!==(e=e.replace(s,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},"object"==typeof r&&"object"==typeof t?t.exports=u:"object"==typeof r?r.URLToolkit=u:n.URLToolkit=u},{}],3:[function(e,t,r){var n=arguments[3],a=arguments[4],i=arguments[5],o=JSON.stringify;t.exports=function(e,t){for(var r,s=Object.keys(i),u=0,l=s.length;u<l;u++){var f=s[u],c=i[f].exports;if(c===e||c&&c.default===e){r=f;break}}if(!r){r=Math.floor(Math.pow(16,8)*Math.random()).toString(16);var d={};for(u=0,l=s.length;u<l;u++)d[f=s[u]]=f;a[r]=[Function(["require","module","exports"],"("+e+")(self)"),d]}var h=Math.floor(Math.pow(16,8)*Math.random()).toString(16),v={};v[r]=r,a[h]=[Function(["require"],"var f = require("+o(r)+");(f.default ? f.default : f)(self);"),v];var p={};!function e(t){for(var r in p[t]=!0,a[t][1]){var n=a[t][1][r];p[n]||e(n)}}(h);var g="("+n+")({"+Object.keys(p).map((function(e){return o(e)+":["+a[e][0]+","+o(a[e][1])+"]"})).join(",")+"},{},["+o(h)+"])",y=window.URL||window.webkitURL||window.mozURL||window.msURL,m=new Blob([g],{type:"text/javascript"});if(t&&t.bare)return m;var b=y.createObjectURL(m),E=new Worker(b);return E.objectURL=b,E}},{}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.hlsDefaultConfig=void 0;var n=u(e(5)),a=u(e(6)),i=u(e(7)),o=u(e(8)),s=u(e(48));function u(e){return e&&e.__esModule?e:{default:e}}r.hlsDefaultConfig={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,maxSeekHole:2,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,fragLoadingLoopThreshold:3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:s.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,fetchSetup:void 0,abrController:n.default,bufferController:a.default,capLevelController:i.default,fpsController:o.default,stretchShortVideoTrack:!1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0}},{48:48,5:5,6:6,7:7,8:8}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=f(e(30)),i=f(e(29)),o=f(e(32)),s=e(28),u=e(46),l=f(e(44));function f(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.FRAG_LOADING,a.default.FRAG_LOADED,a.default.FRAG_BUFFERED,a.default.ERROR));return r.lastLoadedFragLevel=0,r._nextAutoLevel=-1,r.hls=e,r.timer=null,r._bwEstimator=null,r.onCheck=r._abandonRulesCheck.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){this.clearTimer(),i.default.prototype.destroy.call(this)}},{key:"onFragLoading",value:function(e){var t=e.frag;if("main"===t.type){if(this.timer||(this.timer=setInterval(this.onCheck,100)),!this._bwEstimator){var r=this.hls,n=e.frag.level,a=r.levels[n].details.live,i=r.config,o=void 0,s=void 0;a?(o=i.abrEwmaFastLive,s=i.abrEwmaSlowLive):(o=i.abrEwmaFastVoD,s=i.abrEwmaSlowVoD),this._bwEstimator=new l.default(r,s,o,i.abrEwmaDefaultEstimate)}this.fragCurrent=t}}},{key:"_abandonRulesCheck",value:function(){var e=this.hls,t=e.media,r=this.fragCurrent,n=r.loader,i=e.minAutoLevel;if(!n||n.stats&&n.stats.aborted)return u.logger.warn("frag loader destroy or aborted, disarm abandonRules"),void this.clearTimer();var s=n.stats;if(t&&s&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&r.autoLevel&&r.level){var l=performance.now()-s.trequest,f=Math.abs(t.playbackRate);if(l>500*r.duration/f){var c=e.levels,d=Math.max(1,s.bw?s.bw/8:1e3*s.loaded/l),h=c[r.level],v=h.realBitrate?Math.max(h.realBitrate,h.bitrate):h.bitrate,p=s.total?s.total:Math.max(s.loaded,Math.round(r.duration*v/8)),g=t.currentTime,y=(p-s.loaded)/d,m=(o.default.bufferInfo(t,g,e.config.maxBufferHole).end-g)/f;if(m<2*r.duration/f&&y>m){var b=void 0,E=void 0;for(E=r.level-1;E>i;E--){var _=c[E].realBitrate?Math.max(c[E].realBitrate,c[E].bitrate):c[E].bitrate;if((b=r.duration*_/(6.4*d))<m)break}b<y&&(u.logger.warn("loading too slow, abort fragment loading and switch to level "+E+":fragLoadedDelay["+E+"]<fragLoadedDelay["+(r.level-1)+"];bufferStarvationDelay:"+b.toFixed(1)+"<"+y.toFixed(1)+":"+m.toFixed(1)),e.nextLoadLevel=E,this._bwEstimator.sample(l,s.loaded),n.abort(),this.clearTimer(),e.trigger(a.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,stats:s}))}}}}},{key:"onFragLoaded",value:function(e){var t=e.frag;if("main"===t.type&&!isNaN(t.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var r=this.hls.levels[t.level],n=(r.loaded?r.loaded.bytes:0)+e.stats.loaded,a=(r.loaded?r.loaded.duration:0)+e.frag.duration;r.loaded={bytes:n,duration:a},r.realBitrate=Math.round(8*n/a)}if(e.frag.bitrateTest){var i=e.stats;i.tparsed=i.tbuffered=i.tload,this.onFragBuffered(e)}}}},{key:"onFragBuffered",value:function(e){var t=e.stats,r=e.frag;if(!(!0===t.aborted||1!==r.loadCounter||"main"!==r.type||isNaN(r.sn)||r.bitrateTest&&t.tload!==t.tbuffered)){var n=t.tparsed-t.trequest;u.logger.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(n,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),r.bitrateTest?this.bitrateTestDelay=n/1e3:this.bitrateTestDelay=0}}},{key:"onError",value:function(e){switch(e.details){case s.ErrorDetails.FRAG_LOAD_ERROR:case s.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}}},{key:"clearTimer",value:function(){clearInterval(this.timer),this.timer=null}},{key:"_findBestLevel",value:function(e,t,r,n,a,i,o,s,l){for(var f=a;f>=n;f--){var c=l[f].details,d=c?c.totalduration/c.fragments.length:t,h=!!c&&c.live,v=void 0;v=f<=e?o*r:s*r;var p=l[f].realBitrate?Math.max(l[f].realBitrate,l[f].bitrate):l[f].bitrate,g=p*d/v;if(u.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+f+"/"+Math.round(v)+"/"+p+"/"+d+"/"+i+"/"+g),v>p&&(!g||h&&!this.bitrateTestDelay||g<i))return f}return-1}},{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var r=this._nextABRAutoLevel;return-1!==e&&(r=Math.min(e,r)),r},set:function(e){this._nextAutoLevel=e}},{key:"_nextABRAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,r=e.levels,n=e.config,a=e.minAutoLevel,i=e.media,s=this.lastLoadedFragLevel,l=this.fragCurrent?this.fragCurrent.duration:0,f=i?i.currentTime:0,c=i&&0!==i.playbackRate?Math.abs(i.playbackRate):1,d=this._bwEstimator?this._bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,h=(o.default.bufferInfo(i,f,n.maxBufferHole).end-f)/c,v=this._findBestLevel(s,l,d,a,t,h,n.abrBandWidthFactor,n.abrBandWidthUpFactor,r);if(v>=0)return v;u.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var p=l?Math.min(l,n.maxStarvationDelay):n.maxStarvationDelay,g=n.abrBandWidthFactor,y=n.abrBandWidthUpFactor;if(0===h){var m=this.bitrateTestDelay;m&&(p=(l?Math.min(l,n.maxLoadingDelay):n.maxLoadingDelay)-m,u.logger.trace("bitrate test took "+Math.round(1e3*m)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*p)+" ms"),g=y=1)}return v=this._findBestLevel(s,l,d,a,t,h+p,g,y,r),Math.max(v,0)}}]),t}(i.default);r.default=c},{28:28,29:29,30:30,32:32,44:44,46:46}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=u(e(30)),i=u(e(29)),o=e(46),s=e(28);function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.MEDIA_ATTACHING,a.default.MEDIA_DETACHING,a.default.MANIFEST_PARSED,a.default.BUFFER_RESET,a.default.BUFFER_APPENDING,a.default.BUFFER_CODECS,a.default.BUFFER_EOS,a.default.BUFFER_FLUSHING,a.default.LEVEL_PTS_UPDATED,a.default.LEVEL_UPDATED));return r._msDuration=null,r._levelDuration=null,r.onsbue=r.onSBUpdateEnd.bind(r),r.onsbe=r.onSBUpdateError.bind(r),r.pendingTracks={},r.tracks={},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){i.default.prototype.destroy.call(this)}},{key:"onLevelPtsUpdated",value:function(e){var t=e.type,r=this.tracks.audio;if("audio"===t&&r&&"audio/mpeg"===r.container){var n=this.sourceBuffer.audio;if(Math.abs(n.timestampOffset-e.start)>.1){var a=n.updating;try{n.abort()}catch(e){a=!0,o.logger.warn("can not abort audio buffer: "+e)}a?this.audioTimestampOffset=e.start:(o.logger.warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+e.start),n.timestampOffset=e.start)}}}},{key:"onManifestParsed",value:function(e){var t=e.audio,r=e.video||e.levels.length&&e.audio,n=0;e.altAudio&&(t||r)&&(n=(t?1:0)+(r?1:0),o.logger.log(n+" sourceBuffer(s) expected")),this.sourceBufferNb=n}},{key:"onMediaAttaching",value:function(e){var t=this.media=e.media;if(t){var r=this.mediaSource=new MediaSource;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),r.addEventListener("sourceopen",this.onmso),r.addEventListener("sourceended",this.onmse),r.addEventListener("sourceclose",this.onmsc),t.src=URL.createObjectURL(r)}}},{key:"onMediaDetaching",value:function(){o.logger.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){o.logger.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this.onmso),e.removeEventListener("sourceended",this.onmse),e.removeEventListener("sourceclose",this.onmsc),this.media&&(URL.revokeObjectURL(this.media.src),this.media.removeAttribute("src"),this.media.load()),this.mediaSource=null,this.media=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(a.default.MEDIA_DETACHED)}},{key:"onMediaSourceOpen",value:function(){o.logger.log("media source opened"),this.hls.trigger(a.default.MEDIA_ATTACHED,{media:this.media});var e=this.mediaSource;e&&e.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()}},{key:"checkPendingTracks",value:function(){var e=this.pendingTracks,t=Object.keys(e).length;t&&(this.sourceBufferNb<=t||0===this.sourceBufferNb)&&(this.createSourceBuffers(e),this.pendingTracks={},this.doAppending())}},{key:"onMediaSourceClose",value:function(){o.logger.log("media source closed")}},{key:"onMediaSourceEnded",value:function(){o.logger.log("media source ended")}},{key:"onSBUpdateEnd",value:function(){if(this.audioTimestampOffset){var e=this.sourceBuffer.audio;o.logger.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+this.audioTimestampOffset),e.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var t=this.parent,r=this.segments.reduce((function(e,r){return r.parent===t?e+1:e}),0);this.hls.trigger(a.default.BUFFER_APPENDED,{parent:t,pending:r}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration()}},{key:"onSBUpdateError",value:function(e){o.logger.error("sourceBuffer error:",e),this.hls.trigger(a.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:"onBufferReset",value:function(){var e=this.sourceBuffer;for(var t in e){var r=e[t];try{this.mediaSource.removeSourceBuffer(r),r.removeEventListener("updateend",this.onsbue),r.removeEventListener("error",this.onsbe)}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}},{key:"onBufferCodecs",value:function(e){if(0===Object.keys(this.sourceBuffer).length){for(var t in e)this.pendingTracks[t]=e[t];var r=this.mediaSource;r&&"open"===r.readyState&&this.checkPendingTracks()}}},{key:"createSourceBuffers",value:function(e){var t=this.sourceBuffer,r=this.mediaSource;for(var n in e)if(!t[n]){var i=e[n],u=i.levelCodec||i.codec,l=i.container+";codecs="+u;o.logger.log("creating sourceBuffer("+l+")");try{var f=t[n]=r.addSourceBuffer(l);f.addEventListener("updateend",this.onsbue),f.addEventListener("error",this.onsbe),this.tracks[n]={codec:u,container:i.container},i.buffer=f}catch(e){o.logger.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(a.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:l})}}this.hls.trigger(a.default.BUFFER_CREATED,{tracks:e})}},{key:"onBufferAppending",value:function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())}},{key:"onBufferAppendFail",value:function(e){o.logger.error("sourceBuffer error:",e.event),this.hls.trigger(a.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:"onBufferEos",value:function(e){var t=this.sourceBuffer,r=e.type;for(var n in t)r&&n!==r||t[n].ended||(t[n].ended=!0,o.logger.log(n+" sourceBuffer now EOS"));this.checkEos()}},{key:"checkEos",value:function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var r in e){var n=e[r];if(!n.ended)return;if(n.updating)return void(this._needsEos=!0)}o.logger.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){o.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1}},{key:"onBufferFlushing",value:function(e){this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}),this.flushBufferCounter=0,this.doFlush()}},{key:"onLevelUpdated",value:function(e){var t=e.details;0!==t.fragments.length&&(this._levelDuration=t.totalduration+t.fragments[0].start,this.updateMediaElementDuration())}},{key:"updateMediaElementDuration",value:function(){var e=this.media,t=this.mediaSource,r=this.sourceBuffer,n=this._levelDuration;if(null!==n&&e&&t&&r&&0!==e.readyState&&"open"===t.readyState){for(var a in r)if(r[a].updating)return;null===this._msDuration&&(this._msDuration=t.duration);var i=e.duration;(n>this._msDuration&&n>i||i===1/0||isNaN(i))&&(o.logger.log("Updating mediasource duration to "+n.toFixed(3)),this._msDuration=t.duration=n)}}},{key:"doFlush",value:function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,r=this.sourceBuffer;try{for(var n in r)t+=r[n].buffered.length}catch(e){o.logger.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(a.default.BUFFER_FLUSHED)}}},{key:"doAppending",value:function(){var e=this.hls,t=this.sourceBuffer,r=this.segments;if(Object.keys(t).length){if(this.media.error)return this.segments=[],void o.logger.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(r&&r.length){var n=r.shift();try{var i=t[n.type];i?i.updating?r.unshift(n):(i.ended=!1,this.parent=n.parent,i.appendBuffer(n.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(t){o.logger.error("error while trying to append buffer:"+t.message),r.unshift(n);var u={type:s.ErrorTypes.MEDIA_ERROR,parent:n.parent};if(22===t.code)return this.segments=[],u.details=s.ErrorDetails.BUFFER_FULL_ERROR,u.fatal=!1,void e.trigger(a.default.ERROR,u);if(this.appendError?this.appendError++:this.appendError=1,u.details=s.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>e.config.appendErrorMaxRetry)return o.logger.log("fail "+e.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),r=[],u.fatal=!0,void e.trigger(a.default.ERROR,u);u.fatal=!1,e.trigger(a.default.ERROR,u)}}}}},{key:"flushBuffer",value:function(e,t,r){var n,a,i,s,u,l,f=this.sourceBuffer;if(Object.keys(f).length){if(o.logger.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+e+"/"+t),this.flushBufferCounter<this.appended){for(var c in f)if(!r||c===r){if((n=f[c]).ended=!1,n.updating)return o.logger.warn("cannot flush, sb updating in progress"),!1;try{for(a=0;a<n.buffered.length;a++)if(i=n.buffered.start(a),s=n.buffered.end(a),-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&t===Number.POSITIVE_INFINITY?(u=e,l=t):(u=Math.max(i,e),l=Math.min(s,t)),Math.min(l,s)-u>.5)return this.flushBufferCounter++,o.logger.log("flush "+c+" ["+u+","+l+"], of ["+i+","+s+"], pos:"+this.media.currentTime),n.remove(u,l),!1}catch(e){o.logger.warn("exception while accessing sourcebuffer, it might have been removed from MediaSource")}}}else o.logger.warn("abort flushing too many retries");o.logger.log("buffer flushed")}return!0}}]),t}(i.default);r.default=l},{28:28,29:29,30:30,46:46}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=i(e(30));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.FPS_DROP_LEVEL_CAPPING,a.default.MEDIA_ATTACHING,a.default.MANIFEST_PARSED))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){this.hls.config.capLevelToPlayerSize&&(this.media=this.restrictedLevels=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer)))}},{key:"onFpsDropLevelCapping",value:function(e){t.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)}},{key:"onMediaAttaching",value:function(e){this.media=e.media instanceof HTMLVideoElement?e.media:null}},{key:"onManifestParsed",value:function(e){var t=this.hls;this.restrictedLevels=[],t.config.capLevelToPlayerSize&&(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.levels=e.levels,t.firstLevel=this.getMaxLevel(e.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}},{key:"detectPlayerSize",value:function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}},{key:"getMaxLevel",value:function(e){var r=this;if(!this.levels)return-1;var n=this.levels.filter((function(n,a){return t.isLevelAllowed(a,r.restrictedLevels)&&a<=e}));return t.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}},{key:"mediaWidth",get:function(){var e=void 0,r=this.media;return r&&(e=r.width||r.clientWidth||r.offsetWidth,e*=t.contentScaleFactor),e}},{key:"mediaHeight",get:function(){var e=void 0,r=this.media;return r&&(e=r.height||r.clientHeight||r.offsetHeight,e*=t.contentScaleFactor),e}}],[{key:"isLevelAllowed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return-1===t.indexOf(e)}},{key:"getMaxLevelByMediaSize",value:function(e,t,r){if(!e||e&&!e.length)return-1;for(var n,a,i=e.length-1,o=0;o<e.length;o+=1){var s=e[o];if((s.width>=t||s.height>=r)&&(n=s,!(a=e[o+1])||n.width!==a.width||n.height!==a.height)){i=o;break}}return i}},{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e}}]),t}(i(e(29)).default);r.default=o},{29:29,30:30}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=s(e(30)),i=s(e(29)),o=e(46);function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.MEDIA_ATTACHING))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1}},{key:"onMediaAttaching",value:function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))}},{key:"checkFPS",value:function(e,t,r){var n=performance.now();if(t){if(this.lastTime){var i=n-this.lastTime,s=r-this.lastDroppedFrames,u=t-this.lastDecodedFrames,l=1e3*s/i,f=this.hls;if(f.trigger(a.default.FPS_DROP,{currentDropped:s,currentDecoded:u,totalDroppedFrames:r}),l>0&&s>f.config.fpsDroppedMonitoringThreshold*u){var c=f.currentLevel;o.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+c),c>0&&(-1===f.autoLevelCapping||f.autoLevelCapping>=c)&&(c-=1,f.trigger(a.default.FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:f.currentLevel}),f.autoLevelCapping=c,f.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=r,this.lastDecodedFrames=t}}},{key:"checkFPSInterval",value:function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}]),t}(i.default);r.default=u},{29:29,30:30,46:46}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=s(e(30)),i=s(e(29)),o=s(e(22));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.MEDIA_ATTACHED,a.default.MEDIA_DETACHING,a.default.FRAG_PARSING_METADATA));return r.id3Track=void 0,r.media=void 0,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){i.default.prototype.destroy.call(this)}},{key:"onMediaAttached",value:function(e){this.media=e.media,this.media&&(this.id3Track=this.media.addTextTrack("metadata","id3"),this.id3Track.mode="hidden")}},{key:"onMediaDetaching",value:function(){this.media=void 0}},{key:"onFragParsingMetadata",value:function(e){for(var t=e.frag,r=e.samples,n=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,a=0;a<r.length;a++){var i=o.default.getID3Frames(r[a].data);if(i){var s=r[a].pts,u=a<r.length-1?r[a+1].pts:t.endPTS;s===u&&(u+=1e-4);for(var l=0;l<i.length;l++){var f=i[l];if(!o.default.isTimeStampFrame(f)){var c=new n(s,u,"");c.value=f,this.id3Track.addCue(c)}}}}}}]),t}(i.default);r.default=u},{22:22,29:29,30:30}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=l(e(30)),i=l(e(29)),o=e(46),s=e(28),u=l(e(32));function l(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.MANIFEST_LOADED,a.default.LEVEL_LOADED,a.default.FRAG_LOADED,a.default.ERROR));return r.ontick=r.tick.bind(r),r._manualLevel=-1,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){this.cleanTimer(),this._manualLevel=-1}},{key:"cleanTimer",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null)}},{key:"startLoad",value:function(){this.canload=!0;var e=this._levels;e&&e.forEach((function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)})),this.timer&&this.tick()}},{key:"stopLoad",value:function(){this.canload=!1}},{key:"onManifestLoaded",value:function(e){var t,r=[],n=[],i={},u=!1,l=!1,f=this.hls,c=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),d=function(e,t){return MediaSource.isTypeSupported(e+"/mp4;codecs="+t)};if(e.levels.forEach((function(e){e.videoCodec&&(u=!0),c&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),(e.audioCodec||e.attrs&&e.attrs.AUDIO)&&(l=!0);var t=i[e.bitrate];void 0===t?(i[e.bitrate]=r.length,e.url=[e.url],e.urlId=0,r.push(e)):r[t].url.push(e.url)})),u&&l?r.forEach((function(e){e.videoCodec&&n.push(e)})):n=r,(n=n.filter((function(e){var t=e.audioCodec,r=e.videoCodec;return(!t||d("audio",t))&&(!r||d("video",r))}))).length){t=n[0].bitrate,n.sort((function(e,t){return e.bitrate-t.bitrate})),this._levels=n;for(var h=0;h<n.length;h++)if(n[h].bitrate===t){this._firstLevel=h,o.logger.log("manifest loaded,"+n.length+" level(s) found, first bitrate:"+t);break}f.trigger(a.default.MANIFEST_PARSED,{levels:n,firstLevel:this._firstLevel,stats:e.stats,audio:l,video:u,altAudio:e.audioTracks.length>0})}else f.trigger(a.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:f.url,reason:"no level with compatible codecs found in manifest"})}},{key:"setLevelInternal",value:function(e){var t=this._levels,r=this.hls;if(e>=0&&e<t.length){if(this.cleanTimer(),this._level!==e){o.logger.log("switching to level "+e),this._level=e;var n=t[e];n.level=e,r.trigger(a.default.LEVEL_SWITCH,n),r.trigger(a.default.LEVEL_SWITCHING,n)}var i=t[e],u=i.details;if(!u||!0===u.live){var l=i.urlId;r.trigger(a.default.LEVEL_LOADING,{url:i.url[l],level:e,id:l})}}else r.trigger(a.default.ERROR,{type:s.ErrorTypes.OTHER_ERROR,details:s.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})}},{key:"onError",value:function(e){if(e.fatal)e.type===s.ErrorTypes.NETWORK_ERROR&&this.cleanTimer();else{var t=e.details,r=this.hls,n=void 0,a=void 0,i=!1;switch(t){case s.ErrorDetails.FRAG_LOAD_ERROR:case s.ErrorDetails.FRAG_LOAD_TIMEOUT:case s.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case s.ErrorDetails.KEY_LOAD_ERROR:case s.ErrorDetails.KEY_LOAD_TIMEOUT:n=e.frag.level;break;case s.ErrorDetails.LEVEL_LOAD_ERROR:case s.ErrorDetails.LEVEL_LOAD_TIMEOUT:n=e.context.level,i=!0;break;case s.ErrorDetails.REMUX_ALLOC_ERROR:n=e.level}if(void 0!==n){(a=this._levels[n]).loadError?a.loadError++:a.loadError=1;var l=a.url.length;if(l>1&&a.loadError<l)a.urlId=(a.urlId+1)%l,a.details=void 0,o.logger.warn("level controller,"+t+" for level "+n+": switching to redundant stream id "+a.urlId);else if(-1===this._manualLevel&&n)o.logger.warn("level controller,"+t+": switch-down for next fragment"),r.nextAutoLevel=Math.max(0,n-1);else if(a&&a.details&&a.details.live)o.logger.warn("level controller,"+t+" on live stream, discard"),i&&(this._level=void 0);else if(t===s.ErrorDetails.LEVEL_LOAD_ERROR||t===s.ErrorDetails.LEVEL_LOAD_TIMEOUT){var f=r.media;if(f&&u.default.isBuffered(f,f.currentTime)&&u.default.isBuffered(f,f.currentTime+.5)){var c=r.config.levelLoadingRetryDelay;o.logger.warn("level controller,"+t+", but media buffered, retry in "+c+"ms"),this.timer=setTimeout(this.ontick,c),e.levelRetry=!0}else o.logger.error("cannot recover "+t+" error"),this._level=void 0,this.cleanTimer(),e.fatal=!0}}}}},{key:"onFragLoaded",value:function(e){var t=e.frag;if(t&&"main"===t.type){var r=this._levels[t.level];r&&(r.loadError=0)}}},{key:"onLevelLoaded",value:function(e){var t=e.level;if(t===this._level){var r=this._levels[t];r.loadError=0;var n=e.details;if(n.live){var a=1e3*(n.averagetargetduration?n.averagetargetduration:n.targetduration),i=r.details;i&&n.endSN===i.endSN&&(a/=2,o.logger.log("same live playlist, reload twice faster")),a-=performance.now()-e.stats.trequest,a=Math.max(1e3,Math.round(a)),o.logger.log("live playlist, reload in "+a+" ms"),this.timer=setTimeout(this.ontick,a)}else this.timer=null}}},{key:"tick",value:function(){var e=this._level;if(void 0!==e&&this.canload){var t=this._levels[e];if(t&&t.url){var r=t.urlId;this.hls.trigger(a.default.LEVEL_LOADING,{url:t.url[r],level:e,id:r})}}}},{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this._level},set:function(e){var t=this._levels;t&&t.length>e&&(this._level===e&&void 0!==t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this._manualLevel},set:function(e){this._manualLevel=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this._manualLevel?this._manualLevel:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this._manualLevel&&(this.hls.nextAutoLevel=e)}}]),t}(i.default);r.default=f},{28:28,29:29,30:30,32:32,46:46}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=h(e(43)),i=h(e(32)),o=h(e(20)),s=h(e(30)),u=h(e(29)),l=h(e(33)),f=h(e(47)),c=e(28),d=e(46);function h(e){return e&&e.__esModule?e:{default:e}}var v="STOPPED",p="IDLE",g="KEY_LOADING",y="FRAG_LOADING",m="FRAG_LOADING_WAITING_RETRY",b="WAITING_LEVEL",E="PARSING",_="PARSED",T="BUFFER_FLUSHING",A="ENDED",S="ERROR",k=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,s.default.MEDIA_ATTACHED,s.default.MEDIA_DETACHING,s.default.MANIFEST_LOADING,s.default.MANIFEST_PARSED,s.default.LEVEL_LOADED,s.default.KEY_LOADED,s.default.FRAG_LOADED,s.default.FRAG_LOAD_EMERGENCY_ABORTED,s.default.FRAG_PARSING_INIT_SEGMENT,s.default.FRAG_PARSING_DATA,s.default.FRAG_PARSED,s.default.ERROR,s.default.AUDIO_TRACK_SWITCHING,s.default.AUDIO_TRACK_SWITCHED,s.default.BUFFER_CREATED,s.default.BUFFER_APPENDED,s.default.BUFFER_FLUSHED));return r.config=e.config,r.audioCodecSwap=!1,r.ticks=0,r._state=v,r.ontick=r.tick.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),u.default.prototype.destroy.call(this),this.state=v}},{key:"startLoad",value:function(e){if(this.levels){var t=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var n=r.startLevel;-1===n&&(n=0,this.bitrateTest=!0),this.level=r.nextLoadLevel=n,this.loadedmetadata=!1}t>0&&-1===e&&(d.logger.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=p,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=v}},{key:"stopLoad",value:function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=v,this.forceStartLoad=!1}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){switch(this.state){case S:break;case T:this.fragLoadError=0;break;case p:this._doTickIdle();break;case b:var e=this.levels[this.level];e&&e.details&&(this.state=p);break;case m:var t=performance.now(),r=this.retryDate;(!r||t>=r||this.media&&this.media.seeking)&&(d.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=p)}this._checkBuffer(),this._checkFragmentChanged()}},{key:"_doTickIdle",value:function(){var e=this.hls,t=e.config,r=this.media;if(void 0===this.levelLastLoaded||r||!this.startFragRequested&&t.startFragPrefetch){var n=void 0;n=this.loadedmetadata?r.currentTime:this.nextLoadPosition;var a=e.nextLoadLevel,o=this.levels[a];if(o){var u=o.bitrate,l=void 0;l=u?Math.max(8*t.maxBufferSize/u,t.maxBufferLength):t.maxBufferLength,l=Math.min(l,t.maxMaxBufferLength);var f=i.default.bufferInfo(this.mediaBuffer?this.mediaBuffer:r,n,t.maxBufferHole),c=f.len;if(!(c>=l)){d.logger.trace("buffer length of "+c.toFixed(3)+" is below max of "+l.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=a;var h=o.details;if(void 0===h||h.live&&this.levelLastLoaded!==a)this.state=b;else{var v=this.fragPrevious;if(!h.live&&v&&v.sn===h.endSN&&c&&!f.nextStart&&Math.min(r.duration,v.start+v.duration)-Math.max(f.end,v.start)<=Math.max(.2,v.duration)){var p={};return this.altAudio&&(p.type="video"),this.hls.trigger(s.default.BUFFER_EOS,p),void(this.state=A)}this._fetchPayloadOrEos(n,f,h)}}}}}},{key:"_fetchPayloadOrEos",value:function(e,t,r){var n=this.fragPrevious,a=this.level,i=r.fragments,o=i.length;if(0!==o){var s=i[0].start,u=i[o-1].start+i[o-1].duration,l=t.end,f=void 0;if(r.initSegment&&!r.initSegment.data)f=r.initSegment;else if(r.live){var c=this.config.initialLiveManifestSize;if(o<c)return void d.logger.warn("Can not start playback of a level, reason: not enough fragments "+o+" < "+c);if(null===(f=this._ensureFragmentAtLivePoint(r,l,s,u,n,i,o)))return}else l<s&&(f=i[0]);f||(f=this._findFragment(s,n,o,i,l,u,r)),f&&this._loadFragmentOrKey(f,a,r,e,l)}}},{key:"_ensureFragmentAtLivePoint",value:function(e,t,r,n,i,o,s){var u=this.hls.config,l=this.media,f=void 0,c=void 0!==u.liveMaxLatencyDuration?u.liveMaxLatencyDuration:u.liveMaxLatencyDurationCount*e.targetduration;if(t<Math.max(r-u.maxFragLookUpTolerance,n-c)){var h=this.liveSyncPosition=this.computeLivePosition(r,e);d.logger.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+h.toFixed(3)),t=h,l&&l.readyState&&l.duration>h&&(l.currentTime=h),this.nextLoadPosition=h}if(e.PTSKnown&&t>n&&l&&l.readyState)return null;if(this.startFragRequested&&!e.PTSKnown){if(i){var v=i.sn+1;if(v>=e.startSN&&v<=e.endSN){var p=o[v-e.startSN];i.cc===p.cc&&(f=p,d.logger.log("live playlist, switching playlist, load frag with next SN: "+f.sn))}f||(f=a.default.search(o,(function(e){return i.cc-e.cc})))&&d.logger.log("live playlist, switching playlist, load frag with same CC: "+f.sn)}f||(f=o[Math.min(s-1,Math.round(s/2))],d.logger.log("live playlist, switching playlist, unknown, load middle frag : "+f.sn))}return f}},{key:"_findFragment",value:function(e,t,r,n,i,o,s){var u=this.hls.config,l=void 0,f=void 0,c=u.maxFragLookUpTolerance,h=t?n[t.sn-n[0].sn+1]:void 0,v=function(e){var t=Math.min(c,e.duration);return e.start+e.duration-t<=i?1:e.start-t>i&&e.start?-1:0};if(i<o?(i>o-c&&(c=0),f=h&&!v(h)?h:a.default.search(n,v)):f=n[r-1],f){var p=(l=f).sn-s.startSN,g=t&&l.level===t.level,y=n[p-1],m=n[p+1];if(t&&l.sn===t.sn)if(g&&!l.backtracked)if(l.sn<s.endSN){var b=t.deltaPTS;b&&b>u.maxBufferHole&&t.dropped&&p?(l=y,d.logger.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this"),t.loadCounter--):(l=m,d.logger.log("SN just loaded, load next one: "+l.sn))}else l=null;else l.backtracked&&(m&&m.backtracked?(d.logger.warn("Already backtracked from fragment "+m.sn+", will not backtrack to fragment "+l.sn+". Loading fragment "+m.sn),l=m):(d.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),l.dropped=0,y?(y.loadCounter&&y.loadCounter--,(l=y).backtracked=!0):p&&(l=null)))}return l}},{key:"_loadFragmentOrKey",value:function(e,t,r,n,a){var i=this.hls,u=i.config;if(!e.decryptdata||null==e.decryptdata.uri||null!=e.decryptdata.key){if(d.logger.log("Loading "+e.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+t+", currentTime:"+n.toFixed(3)+",bufferEnd:"+a.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,e.loadCounter){e.loadCounter++;var l=u.fragLoadingLoopThreshold;if(e.loadCounter>l&&Math.abs(this.fragLoadIdx-e.loadIdx)<l)return void i.trigger(s.default.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:e})}else e.loadCounter=1;return e.loadIdx=this.fragLoadIdx,this.fragCurrent=e,this.startFragRequested=!0,isNaN(e.sn)||(this.nextLoadPosition=e.start+e.duration),e.autoLevel=i.autoLevelEnabled,e.bitrateTest=this.bitrateTest,i.trigger(s.default.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new o.default(i,"main")),void(this.state=y)}d.logger.log("Loading key for "+e.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+t),this.state=g,i.trigger(s.default.KEY_LOADING,{frag:e})}},{key:"getBufferedFrag",value:function(e){return a.default.search(this._bufferedFrags,(function(t){return e<t.startPTS?-1:e>t.endPTS?1:0}))}},{key:"followingBufferedFrag",value:function(e){return e?this.getBufferedFrag(e.endPTS+.5):null}},{key:"_checkFragmentChanged",value:function(){var e,t,r=this.media;if(r&&r.readyState&&!1===r.seeking&&((t=r.currentTime)>r.playbackRate*this.lastCurrentTime&&(this.lastCurrentTime=t),i.default.isBuffered(r,t)?e=this.getBufferedFrag(t):i.default.isBuffered(r,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var n=e;if(n!==this.fragPlaying){this.hls.trigger(s.default.FRAG_CHANGED,{frag:n});var a=n.level;this.fragPlaying&&this.fragPlaying.level===a||this.hls.trigger(s.default.LEVEL_SWITCHED,{level:a}),this.fragPlaying=n}}}},{key:"immediateLevelSwitch",value:function(){if(d.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e=this.media,t=void 0;e?(t=e.paused,e.pause()):t=!0,this.previouslyPaused=t}var r=this.fragCurrent;r&&r.loader&&r.loader.abort(),this.fragCurrent=null,this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}},{key:"immediateLevelSwitchEnd",value:function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,i.default.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())}},{key:"nextLevelSwitch",value:function(){var e=this.media;if(e&&e.readyState){var t,r=void 0,n=void 0;if(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,(t=this.getBufferedFrag(e.currentTime))&&t.startPTS>1&&this.flushMainBuffer(0,t.startPTS-1),e.paused)r=0;else{var a=this.hls.nextLoadLevel,i=this.levels[a],o=this.fragLastKbps;r=o&&this.fragCurrent?this.fragCurrent.duration*i.bitrate/(1e3*o)+1:0}if((n=this.getBufferedFrag(e.currentTime+r))&&(n=this.followingBufferedFrag(n))){var s=this.fragCurrent;s&&s.loader&&s.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(n.maxStartPTS,Number.POSITIVE_INFINITY)}}}},{key:"flushMainBuffer",value:function(e,t){this.state=T;var r={startOffset:e,endOffset:t};this.altAudio&&(r.type="video"),this.hls.trigger(s.default.BUFFER_FLUSHING,r)}},{key:"onMediaAttached",value:function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.hls.startLoad(r.startPosition)}},{key:"onMediaDetaching",value:function(){var e=this.media;e&&e.ended&&(d.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach((function(e){e.details&&e.details.fragments.forEach((function(e){e.loadCounter=void 0,e.backtracked=void 0}))})),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()}},{key:"onMediaSeeking",value:function(){var e=this.media,t=e?e.currentTime:void 0,r=this.config;isNaN(t)||d.logger.log("media seeking to "+t.toFixed(3));var n=this.mediaBuffer?this.mediaBuffer:e,a=i.default.bufferInfo(n,t,this.config.maxBufferHole);if(this.state===y){var o=this.fragCurrent;if(0===a.len&&o){var s=r.maxFragLookUpTolerance,u=o.start-s,l=o.start+o.duration+s;t<u||t>l?(o.loader&&(d.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),o.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=p):d.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else this.state===A&&(0===a.len&&(this.fragPrevious=0),this.state=p);e&&(this.lastCurrentTime=t),this.state!==y&&void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*r.fragLoadingLoopThreshold),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=t),this.tick()}},{key:"onMediaSeeked",value:function(){var e=this.media,t=e?e.currentTime:void 0;isNaN(t)||d.logger.log("media seeked to "+t.toFixed(3)),this.tick()}},{key:"onMediaEnded",value:function(){d.logger.log("media ended"),this.startPosition=this.lastCurrentTime=0}},{key:"onManifestLoading",value:function(){d.logger.log("trigger BUFFER_RESET"),this.hls.trigger(s.default.BUFFER_RESET),this._bufferedFrags=[],this.stalled=!1,this.startPosition=this.lastCurrentTime=0}},{key:"onManifestParsed",value:function(e){var t,r=!1,n=!1;e.levels.forEach((function(e){(t=e.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(r=!0),-1!==t.indexOf("mp4a.40.5")&&(n=!0))})),this.audioCodecSwitch=r&&n,this.audioCodecSwitch&&d.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startLevelLoaded=!1,this.startFragRequested=!1;var a=this.config;(a.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(a.startPosition)}},{key:"onLevelLoaded",value:function(e){var t=e.details,r=e.level,n=this.levels[r],a=t.totalduration,i=0;if(d.logger.log("level "+r+" loaded ["+t.startSN+","+t.endSN+"],duration:"+a),this.levelLastLoaded=r,t.live){var o=n.details;o&&t.fragments.length>0?(l.default.mergeDetails(o,t),i=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(i,o),t.PTSKnown?d.logger.log("live playlist sliding:"+i.toFixed(3)):d.logger.log("live playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,d.logger.log("live playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(n.details=t,this.hls.trigger(s.default.LEVEL_UPDATED,{details:t,level:r}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var u=t.startTimeOffset;isNaN(u)?t.live?(this.startPosition=this.computeLivePosition(i,t),d.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0:(u<0&&(d.logger.log("negative start time offset "+u+", count from end of last fragment"),u=i+a+u),d.logger.log("start time offset found in playlist, adjust startPosition to "+u),this.startPosition=u),this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===b&&(this.state=p),this.tick()}},{key:"onKeyLoaded",value:function(){this.state===g&&(this.state=p,this.tick())}},{key:"onFragLoaded",value:function(e){var t=this.fragCurrent,r=e.frag;if(this.state===y&&t&&"main"===r.type&&r.level===t.level&&r.sn===t.sn){var n=e.stats,a=this.levels[t.level],i=a.details;if(d.logger.log("Loaded  "+t.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+t.level),this.bitrateTest=!1,this.stats=n,!0===r.bitrateTest&&this.hls.nextLoadLevel)this.state=p,this.startFragRequested=!1,n.tparsed=n.tbuffered=performance.now(),this.hls.trigger(s.default.FRAG_BUFFERED,{stats:n,frag:t,id:"main"}),this.tick();else if("initSegment"===r.sn)this.state=p,n.tparsed=n.tbuffered=performance.now(),i.initSegment.data=e.payload,this.hls.trigger(s.default.FRAG_BUFFERED,{stats:n,frag:t,id:"main"}),this.tick();else{this.state=E;var u=i.totalduration,l=t.level,f=t.sn,c=this.config.defaultAudioCodec||a.audioCodec;this.audioCodecSwap&&(d.logger.log("swapping playlist audio codec"),void 0===c&&(c=this.lastAudioCodec),c&&(c=-1!==c.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),this.pendingBuffering=!0,this.appended=!1,d.logger.log("Parsing "+f+" of ["+i.startSN+" ,"+i.endSN+"],level "+l+", cc "+t.cc);var h=this.demuxer;h||(h=this.demuxer=new o.default(this.hls,"main"));var v=this.media,g=!(v&&v.seeking)&&(i.PTSKnown||!i.live),m=i.initSegment?i.initSegment.data:[];h.push(e.payload,m,c,a.videoCodec,t,u,g,void 0)}}this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function(e){var t=this.fragCurrent,r=e.frag;if(t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===E){var n,a,i=e.tracks;if(i.audio&&this.altAudio&&delete i.audio,a=i.audio){var o=this.levels[this.level].audioCodec,u=navigator.userAgent.toLowerCase();o&&this.audioCodecSwap&&(d.logger.log("swapping playlist audio codec"),o=-1!==o.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==a.metadata.channelCount&&-1===u.indexOf("firefox")&&(o="mp4a.40.5"),-1!==u.indexOf("android")&&"audio/mpeg"!==a.container&&(o="mp4a.40.2",d.logger.log("Android: force audio codec to "+o)),a.levelCodec=o,a.id=e.id}for(n in(a=i.video)&&(a.levelCodec=this.levels[this.level].videoCodec,a.id=e.id),this.hls.trigger(s.default.BUFFER_CODECS,i),i){a=i[n],d.logger.log("main track:"+n+",container:"+a.container+",codecs[level/parsed]=["+a.levelCodec+"/"+a.codec+"]");var l=a.initSegment;l&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(s.default.BUFFER_APPENDING,{type:n,data:l,parent:"main",content:"initSegment"}))}this.tick()}}},{key:"onFragParsingData",value:function(e){var t=this,r=this.fragCurrent,n=e.frag;if(r&&"main"===e.id&&n.sn===r.sn&&n.level===r.level&&("audio"!==e.type||!this.altAudio)&&this.state===E){var a=this.levels[this.level],i=r;if(isNaN(e.endPTS)&&(e.endPTS=e.startPTS+r.duration,e.endDTS=e.startDTS+r.duration),d.logger.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0)),"video"===e.type)if(i.dropped=e.dropped,i.dropped){if(!i.backtracked)return d.logger.warn("missing video frame(s), backtracking fragment"),i.backtracked=!0,this.nextLoadPosition=e.startPTS,this.state=p,this.fragPrevious=i,void this.tick();d.logger.warn("Already backtracked on this fragment, appending with the gap")}else i.backtracked=!1;var o=l.default.updateFragPTSDTS(a.details,i,e.startPTS,e.endPTS,e.startDTS,e.endDTS),u=this.hls;u.trigger(s.default.LEVEL_PTS_UPDATED,{details:a.details,level:this.level,drift:o,type:e.type,start:e.startPTS,end:e.endPTS}),[e.data1,e.data2].forEach((function(r){r&&r.length&&t.state===E&&(t.appended=!0,t.pendingBuffering=!0,u.trigger(s.default.BUFFER_APPENDING,{type:e.type,data:r,parent:"main",content:"data"}))})),this.tick()}}},{key:"onFragParsed",value:function(e){var t=this.fragCurrent,r=e.frag;t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===E&&(this.stats.tparsed=performance.now(),this.state=_,this._checkAppendedParsed())}},{key:"onAudioTrackSwitching",value:function(e){var t=!!e.url,r=e.id;if(!t){if(this.mediaBuffer!==this.media){d.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var n=this.fragCurrent;n.loader&&(d.logger.log("switching to main audio track, cancel main fragment load"),n.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=p}var a=this.hls;a.trigger(s.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),a.trigger(s.default.AUDIO_TRACK_SWITCHED,{id:r}),this.altAudio=!1}}},{key:"onAudioTrackSwitched",value:function(e){var t=e.id,r=!!this.hls.audioTracks[t].url;if(r){var n=this.videoBuffer;n&&this.mediaBuffer!==n&&(d.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=r,this.tick()}},{key:"onBufferCreated",value:function(e){var t=e.tracks,r=void 0,n=void 0,a=!1;for(var i in t){var o=t[i];"main"===o.id?(n=i,r=o,"video"===i&&(this.videoBuffer=t[i].buffer)):a=!0}a&&r?(d.logger.log("alternate track found, use "+n+".buffered to schedule main fragment loading"),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}},{key:"onBufferAppended",value:function(e){if("main"===e.parent){var t=this.state;t!==E&&t!==_||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}}},{key:"_checkAppendedParsed",value:function(){if(!(this.state!==_||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;d.logger.log("main buffered : "+f.default.toString(t.buffered));var r=this._bufferedFrags.filter((function(e){return i.default.isBuffered(t,(e.startPTS+e.endPTS)/2)}));r.push(e),this._bufferedFrags=r.sort((function(e,t){return e.startPTS-t.startPTS})),this.fragPrevious=e;var n=this.stats;n.tbuffered=performance.now(),this.fragLastKbps=Math.round(8*n.total/(n.tbuffered-n.tfirst)),this.hls.trigger(s.default.FRAG_BUFFERED,{stats:n,frag:e,id:"main"}),this.state=p}this.tick()}}},{key:"onError",value:function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var r=this.media,n=r&&i.default.isBuffered(r,r.currentTime)&&i.default.isBuffered(r,r.currentTime+.5);switch(e.details){case c.ErrorDetails.FRAG_LOAD_ERROR:case c.ErrorDetails.FRAG_LOAD_TIMEOUT:case c.ErrorDetails.KEY_LOAD_ERROR:case c.ErrorDetails.KEY_LOAD_TIMEOUT:if(!e.fatal){var a=this.fragLoadError;a?a++:a=1;var o=this.config;if(a<=o.fragLoadingMaxRetry||n||t.autoLevel&&t.level){this.fragLoadError=a,t.loadCounter=0;var s=Math.min(Math.pow(2,a-1)*o.fragLoadingRetryDelay,o.fragLoadingMaxRetryTimeout);d.logger.warn("mediaController: frag loading failed, retry in "+s+" ms"),this.retryDate=performance.now()+s,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.state=m}else d.logger.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=S}break;case c.ErrorDetails.FRAG_LOOP_LOADING_ERROR:e.fatal||(n?(this._reduceMaxBufferLength(t.duration),this.state=p):t.autoLevel&&0!==t.level||(e.fatal=!0,this.state=S));break;case c.ErrorDetails.LEVEL_LOAD_ERROR:case c.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==S&&(e.fatal?(this.state=S,d.logger.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):e.levelRetry||this.state!==b||(this.state=p));break;case c.ErrorDetails.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==E&&this.state!==_||(n?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=p):(d.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}}},{key:"_reduceMaxBufferLength",value:function(e){var t=this.config;t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,d.logger.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),this.fragLoadIdx+=2*t.fragLoadingLoopThreshold)}},{key:"_checkBuffer",value:function(){var e=this.media,t=this.config;if(e&&e.readyState){var r=e.currentTime,n=this.mediaBuffer?this.mediaBuffer:e,a=n.buffered;if(!this.loadedmetadata&&a.length){this.loadedmetadata=!0;var o=e.seeking?r:this.startPosition,u=i.default.isBuffered(n,o),l=a.start(0);(r!==o||!u&&Math.abs(o-l)<t.maxSeekHole)&&(d.logger.log("target start position:"+o),u||(o=l,d.logger.log("target start position not buffered, seek to buffered.start(0) "+o)),d.logger.log("adjust currentTime from "+r+" to "+o),e.currentTime=o)}else if(this.immediateSwitch)this.immediateLevelSwitchEnd();else{var f=i.default.bufferInfo(e,r,0),h=!(e.paused||e.ended||0===e.buffered.length);if(r!==this.lastCurrentTime)this.stallReported&&(d.logger.warn("playback not stuck anymore @"+r+", after "+Math.round(performance.now()-this.stalled)+"ms"),this.stallReported=!1),this.stalled=void 0,this.nudgeRetry=0;else if(h){var v=performance.now(),p=this.hls;if(this.stalled){var g=v-this.stalled,y=f.len,m=this.nudgeRetry||0;if(y<=.5&&g>1e3*t.lowBufferWatchdogPeriod){this.stallReported||(this.stallReported=!0,d.logger.warn("playback stalling in low buffer @"+r),p.trigger(s.default.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:y}));var b=f.nextStart,E=b-r;if(b&&E<t.maxSeekHole&&E>0){this.nudgeRetry=++m;var _=m*t.nudgeOffset;d.logger.log("adjust currentTime from "+e.currentTime+" to next buffered @ "+b+" + nudge "+_),e.currentTime=b+_,this.stalled=void 0,p.trigger(s.default.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,hole:b+_-r})}}else if(y>.5&&g>1e3*t.highBufferWatchdogPeriod)if(this.stallReported||(this.stallReported=!0,d.logger.warn("playback stalling in high buffer @"+r),p.trigger(s.default.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:y})),this.stalled=void 0,this.nudgeRetry=++m,m<t.nudgeMaxRetry){var T=e.currentTime,A=T+m*t.nudgeOffset;d.logger.log("adjust currentTime from "+T+" to "+A),e.currentTime=A,p.trigger(s.default.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else d.logger.error("still stuck in high buffer @"+r+" after "+t.nudgeMaxRetry+", raise fatal error"),p.trigger(s.default.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}else this.stalled=v,this.stallReported=!1}}}}},{key:"onFragLoadEmergencyAborted",value:function(){this.state=p,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()}},{key:"onBufferFlushed",value:function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;this._bufferedFrags=this._bufferedFrags.filter((function(t){return i.default.isBuffered(e,(t.startPTS+t.endPTS)/2)})),this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.state=p,this.fragPrevious=null}},{key:"swapAudioCodec",value:function(){this.audioCodecSwap=!this.audioCodecSwap}},{key:"computeLivePosition",value:function(e,t){var r=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-r)}},{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,d.logger.log("main stream:"+t+"->"+e),this.hls.trigger(s.default.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}]),t}(u.default);r.default=k},{20:20,28:28,29:29,30:30,32:32,33:33,43:43,46:46,47:47}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.subtle=t,this.aesIV=r}return n(e,[{key:"decrypt",value:function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}]),e}();r.default=a},{}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return n(e,[{key:"uint8ArrayToUint32Array_",value:function(e){for(var t=new DataView(e),r=new Uint32Array(4),n=0;n<4;n++)r[n]=t.getUint32(4*n);return r}},{key:"initTable",value:function(){var e=this.sBox,t=this.invSBox,r=this.subMix,n=r[0],a=r[1],i=r[2],o=r[3],s=this.invSubMix,u=s[0],l=s[1],f=s[2],c=s[3],d=new Uint32Array(256),h=0,v=0,p=0;for(p=0;p<256;p++)d[p]=p<128?p<<1:p<<1^283;for(p=0;p<256;p++){var g=v^v<<1^v<<2^v<<3^v<<4;g=g>>>8^255&g^99,e[h]=g,t[g]=h;var y=d[h],m=d[y],b=d[m],E=257*d[g]^16843008*g;n[h]=E<<24|E>>>8,a[h]=E<<16|E>>>16,i[h]=E<<8|E>>>24,o[h]=E,E=16843009*b^65537*m^257*y^16843008*h,u[g]=E<<24|E>>>8,l[g]=E<<16|E>>>16,f[g]=E<<8|E>>>24,c[g]=E,h?(h=y^d[d[d[b^y]]],v^=d[d[v]]):h=v=1}}},{key:"expandKey",value:function(e){for(var t=this.uint8ArrayToUint32Array_(e),r=!0,n=0;n<t.length&&r;)r=t[n]===this.key[n],n++;if(!r){this.key=t;var a=this.keySize=t.length;if(4!==a&&6!==a&&8!==a)throw new Error("Invalid aes key size="+a);var i=this.ksRows=4*(a+6+1),o=void 0,s=void 0,u=this.keySchedule=new Uint32Array(i),l=this.invKeySchedule=new Uint32Array(i),f=this.sBox,c=this.rcon,d=this.invSubMix,h=d[0],v=d[1],p=d[2],g=d[3],y=void 0,m=void 0;for(o=0;o<i;o++)o<a?y=u[o]=t[o]:(m=y,o%a==0?(m=f[(m=m<<8|m>>>24)>>>24]<<24|f[m>>>16&255]<<16|f[m>>>8&255]<<8|f[255&m],m^=c[o/a|0]<<24):a>6&&o%a==4&&(m=f[m>>>24]<<24|f[m>>>16&255]<<16|f[m>>>8&255]<<8|f[255&m]),u[o]=y=(u[o-a]^m)>>>0);for(s=0;s<i;s++)o=i-s,m=3&s?u[o]:u[o-4],l[s]=s<4||o<=4?m:h[f[m>>>24]]^v[f[m>>>16&255]]^p[f[m>>>8&255]]^g[f[255&m]],l[s]=l[s]>>>0}}},{key:"networkToHostOrderSwap",value:function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}},{key:"decrypt",value:function(e,t,r){for(var n,a,i=this.keySize+6,o=this.invKeySchedule,s=this.invSBox,u=this.invSubMix,l=u[0],f=u[1],c=u[2],d=u[3],h=this.uint8ArrayToUint32Array_(r),v=h[0],p=h[1],g=h[2],y=h[3],m=new Int32Array(e),b=new Int32Array(m.length),E=void 0,_=void 0,T=void 0,A=void 0,S=void 0,k=void 0,w=void 0,R=void 0,L=void 0,x=void 0,O=void 0,D=void 0,P=this.networkToHostOrderSwap;t<m.length;){for(L=P(m[t]),x=P(m[t+1]),O=P(m[t+2]),D=P(m[t+3]),S=L^o[0],k=D^o[1],w=O^o[2],R=x^o[3],n=4,a=1;a<i;a++)E=l[S>>>24]^f[k>>16&255]^c[w>>8&255]^d[255&R]^o[n],_=l[k>>>24]^f[w>>16&255]^c[R>>8&255]^d[255&S]^o[n+1],T=l[w>>>24]^f[R>>16&255]^c[S>>8&255]^d[255&k]^o[n+2],A=l[R>>>24]^f[S>>16&255]^c[k>>8&255]^d[255&w]^o[n+3],S=E,k=_,w=T,R=A,n+=4;E=s[S>>>24]<<24^s[k>>16&255]<<16^s[w>>8&255]<<8^s[255&R]^o[n],_=s[k>>>24]<<24^s[w>>16&255]<<16^s[R>>8&255]<<8^s[255&S]^o[n+1],T=s[w>>>24]<<24^s[R>>16&255]<<16^s[S>>8&255]<<8^s[255&k]^o[n+2],A=s[R>>>24]<<24^s[S>>16&255]<<16^s[k>>8&255]<<8^s[255&w]^o[n+3],n+=3,b[t]=P(E^v),b[t+1]=P(A^p),b[t+2]=P(T^g),b[t+3]=P(_^y),v=L,p=x,g=O,y=D,t+=4}return b.buffer}},{key:"destroy",value:function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0}}]),e}();r.default=a},{}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=l(e(12)),i=l(e(15)),o=l(e(13)),s=e(28),u=e(46);function l(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=r,this.logEnabled=!0;try{var n=crypto||self.crypto;this.subtle=n.subtle||n.webkitSubtle}catch(e){}this.disableWebCrypto=!this.subtle}return n(e,[{key:"isSync",value:function(){return this.disableWebCrypto&&this.config.enableSoftwareAES}},{key:"decrypt",value:function(e,t,r,n){var s=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(u.logger.log("JS AES decrypt"),this.logEnabled=!1);var l=this.decryptor;l||(this.decryptor=l=new o.default),l.expandKey(t),n(l.decrypt(e,0,r))}else{this.logEnabled&&(u.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1);var f=this.subtle;this.key!==t&&(this.key=t,this.fastAesKey=new i.default(f,t)),this.fastAesKey.expandKey().then((function(i){new a.default(f,r).decrypt(e,i).catch((function(a){s.onWebCryptoError(a,e,t,r,n)})).then((function(e){n(e)}))})).catch((function(a){s.onWebCryptoError(a,e,t,r,n)}))}}},{key:"onWebCryptoError",value:function(e,t,r,n,a){this.config.enableSoftwareAES?(u.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,r,n,a)):(u.logger.error("decrypting error : "+e.message),this.observer.trigger(Event.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))}},{key:"destroy",value:function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)}}]),e}();r.default=f},{12:12,13:13,15:15,28:28,46:46}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.subtle=t,this.key=r}return n(e,[{key:"expandKey",value:function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}]),e}();r.default=a},{}],16:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=s(e(17)),i=e(46),o=s(e(22));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=n,this.remuxer=r}return n(e,[{key:"resetInitSegment",value:function(e,t,r,n){this._audioTrack={container:"audio/adts",type:"audio",id:-1,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:n,inputTimeScale:9e4}}},{key:"resetTimeStamp",value:function(){}},{key:"append",value:function(e,t,r,n){for(var s=this._audioTrack,u=o.default.getID3Data(e,0),l=90*o.default.getTimeStamp(u),f=0,c=l,d=e.length,h=u.length,v=[{pts:c,dts:c,data:u}];h<d-1;)if(a.default.isHeader(e,h)&&h+5<d){a.default.initTrackConfig(s,this.observer,e,h,s.manifestCodec);var p=a.default.appendFrame(s,e,h,l,f);if(!p){i.logger.log("Unable to parse AAC frame");break}h+=p.length,c=p.sample.pts,f++}else o.default.isHeader(e,h)?(u=o.default.getID3Data(e,h),v.push({pts:c,dts:c,data:u}),h+=u.length):h++;this.remuxer.remux(s,{samples:[]},{samples:v,inputTimeScale:9e4},{samples:[]},t,r,n)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(e){var t,r,n=o.default.getID3Data(e,0);if(n&&void 0!==o.default.getTimeStamp(n))for(t=n.length,r=Math.min(e.length-1,t+100);t<r;t++)if(a.default.probe(e,t))return i.logger.log("ADTS sync word found !"),!0;return!1}}]),e}();r.default=u},{17:17,22:22,46:46}],17:[function(e,t,r){"use strict";var n=e(46),a=e(28),i={getAudioConfig:function(e,t,r,i){var o,s,u,l,f,c=navigator.userAgent.toLowerCase(),d=i,h=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(o=1+((192&t[r+2])>>>6),!((s=(60&t[r+2])>>>2)>h.length-1))return l=(1&t[r+2])<<2,l|=(192&t[r+3])>>>6,n.logger.log("manifest codec:"+i+",ADTS data:type:"+o+",sampleingIndex:"+s+"["+h[s]+"Hz],channelConfig:"+l),/firefox/i.test(c)?s>=6?(o=5,f=new Array(4),u=s-3):(o=2,f=new Array(2),u=s):-1!==c.indexOf("android")?(o=2,f=new Array(2),u=s):(o=5,f=new Array(4),i&&(-1!==i.indexOf("mp4a.40.29")||-1!==i.indexOf("mp4a.40.5"))||!i&&s>=6?u=s-3:((i&&-1!==i.indexOf("mp4a.40.2")&&(s>=6&&1===l||/vivaldi/i.test(c))||!i&&1===l)&&(o=2,f=new Array(2)),u=s)),f[0]=o<<3,f[0]|=(14&s)>>1,f[1]|=(1&s)<<7,f[1]|=l<<3,5===o&&(f[1]|=(14&u)>>1,f[2]=(1&u)<<7,f[2]|=8,f[3]=0),{config:f,samplerate:h[s],channelCount:l,codec:"mp4a.40."+o,manifestCodec:d};e.trigger(Event.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+s})},isHeaderPattern:function(e,t){return 255===e[t]&&240==(246&e[t+1])},getHeaderLength:function(e,t){return 1&e[t+1]?7:9},getFullFrameLength:function(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var r=this.getHeaderLength(e,t);t+5<e.length&&(r=this.getFullFrameLength(e,t));var n=t+r;if(n===e.length||n+1<e.length&&this.isHeaderPattern(e,n))return!0}return!1},initTrackConfig:function(e,t,r,a,i){if(!e.samplerate){var o=this.getAudioConfig(t,r,a,i);e.config=o.config,e.samplerate=o.samplerate,e.channelCount=o.channelCount,e.codec=o.codec,e.manifestCodec=o.manifestCodec,n.logger.log("parsed codec:"+e.codec+",rate:"+o.samplerate+",nb channel:"+o.channelCount)}},getFrameDuration:function(e){return 9216e4/e},appendFrame:function(e,t,r,n,a){var i=this.getFrameDuration(e.samplerate),o=this.parseFrameHeader(t,r,n,a,i);if(o){var s=o.stamp,u=o.headerLength,l=o.frameLength,f={unit:t.subarray(r+u,r+u+l),pts:s,dts:s};return e.samples.push(f),e.len+=l,{sample:f,length:l+u}}},parseFrameHeader:function(e,t,r,n,a){var i,o,s=e.length;if(i=this.getHeaderLength(e,t),o=this.getFullFrameLength(e,t),(o-=i)>0&&t+i+o<=s)return{headerLength:i,frameLength:o,stamp:r+n*a}}};t.exports=i},{28:28,46:46}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=h(e(30)),i=e(28),o=h(e(14)),s=h(e(16)),u=h(e(24)),l=h(e(27)),f=h(e(23)),c=h(e(40)),d=h(e(41));function h(e){return e&&e.__esModule?e:{default:e}}var v=function(){function e(t,r,n,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.typeSupported=r,this.config=n,this.vendor=a}return n(e,[{key:"destroy",value:function(){var e=this.demuxer;e&&e.destroy()}},{key:"push",value:function(e,t,r,n,i,s,u,l,f,c,d,h){if(e.byteLength>0&&null!=t&&null!=t.key&&"AES-128"===t.method){var v=this.decrypter;null==v&&(v=this.decrypter=new o.default(this.observer,this.config));var p,g=this;try{p=performance.now()}catch(e){p=Date.now()}v.decrypt(e,t.key.buffer,t.iv.buffer,(function(e){var o;try{o=performance.now()}catch(e){o=Date.now()}g.observer.trigger(a.default.FRAG_DECRYPTED,{stats:{tstart:p,tdecrypt:o}}),g.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),n,i,s,u,l,f,c,d,h)}))}else this.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),n,i,s,u,l,f,c,d,h)}},{key:"pushDecrypted",value:function(e,t,r,n,o,h,v,p,g,y,m,b){var E=this.demuxer;if(!E||v&&!this.probe(e)){for(var _=this.observer,T=this.typeSupported,A=this.config,S=[{demux:s.default,remux:c.default},{demux:f.default,remux:c.default},{demux:l.default,remux:c.default},{demux:u.default,remux:d.default}],k=0,w=S.length;k<w;k++){var R=S[k],L=R.demux.probe;if(L(e)){var x=this.remuxer=new R.remux(_,A,T,this.vendor);E=new R.demux(_,x,A,T),this.probe=L;break}}if(!E)return void _.trigger(a.default.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=E}var O=this.remuxer;(v||p)&&(E.resetInitSegment(r,n,o,y),O.resetInitSegment()),v&&(E.resetTimeStamp(b),O.resetTimeStamp(b)),"function"==typeof E.setDecryptData&&E.setDecryptData(t),E.append(e,h,g,m)}}]),e}();r.default=v},{14:14,16:16,23:23,24:24,27:27,28:28,30:30,40:40,41:41}],19:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=s(e(18)),a=s(e(30)),i=e(46),o=s(e(1));function s(e){return e&&e.__esModule?e:{default:e}}r.default=function(e){var t=new o.default;t.trigger=function(e){for(var r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];t.emit.apply(t,[e,e].concat(n))},t.off=function(e){for(var r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];t.removeListener.apply(t,[e].concat(n))};var r=function(t,r){e.postMessage({event:t,data:r})};e.addEventListener("message",(function(a){var o=a.data;switch(o.cmd){case"init":var s=JSON.parse(o.config);e.demuxer=new n.default(t,o.typeSupported,s,o.vendor);try{(0,i.enableLogs)(!0===s.debug)}catch(e){console.warn("demuxerWorker: unable to enable logs")}r("init",null);break;case"demux":e.demuxer.push(o.data,o.decryptdata,o.initSegment,o.audioCodec,o.videoCodec,o.timeOffset,o.discontinuity,o.trackSwitch,o.contiguous,o.duration,o.accurateTimeOffset,o.defaultInitPTS)}})),t.on(a.default.FRAG_DECRYPTED,r),t.on(a.default.FRAG_PARSING_INIT_SEGMENT,r),t.on(a.default.FRAG_PARSED,r),t.on(a.default.ERROR,r),t.on(a.default.FRAG_PARSING_METADATA,r),t.on(a.default.FRAG_PARSING_USERDATA,r),t.on(a.default.INIT_PTS_FOUND,r),t.on(a.default.FRAG_PARSING_DATA,(function(t,r){var n=[],a={event:t,data:r};r.data1&&(a.data1=r.data1.buffer,n.push(r.data1.buffer),delete r.data1),r.data2&&(a.data2=r.data2.buffer,n.push(r.data2.buffer),delete r.data2),e.postMessage(a,n)}))}},{1:1,18:18,30:30,46:46}],20:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=f(e(30)),i=f(e(18)),o=f(e(19)),s=e(46),u=e(28),l=f(e(1));function f(e){return e&&e.__esModule?e:{default:e}}var c=function(){function t(r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.hls=r,this.id=n;var f=this.observer=new l.default,c=r.config;f.trigger=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];f.emit.apply(f,[e,e].concat(r))},f.off=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];f.removeListener.apply(f,[e].concat(r))};var d=function(e,t){(t=t||{}).frag=this.frag,t.id=this.id,r.trigger(e,t)}.bind(this);f.on(a.default.FRAG_DECRYPTED,d),f.on(a.default.FRAG_PARSING_INIT_SEGMENT,d),f.on(a.default.FRAG_PARSING_DATA,d),f.on(a.default.FRAG_PARSED,d),f.on(a.default.ERROR,d),f.on(a.default.FRAG_PARSING_METADATA,d),f.on(a.default.FRAG_PARSING_USERDATA,d),f.on(a.default.INIT_PTS_FOUND,d);var h={mp4:MediaSource.isTypeSupported("video/mp4"),mpeg:MediaSource.isTypeSupported("audio/mpeg"),mp3:MediaSource.isTypeSupported('audio/mp4; codecs="mp3"')},v=navigator.vendor;if(c.enableWorker&&"undefined"!=typeof Worker){s.logger.log("demuxing in webworker");var p=void 0;try{var g=e(3);p=this.w=g(o.default),this.onwmsg=this.onWorkerMessage.bind(this),p.addEventListener("message",this.onwmsg),p.onerror=function(e){r.trigger(a.default.ERROR,{type:u.ErrorTypes.OTHER_ERROR,details:u.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})},p.postMessage({cmd:"init",typeSupported:h,vendor:v,id:n,config:JSON.stringify(c)})}catch(e){s.logger.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),p&&URL.revokeObjectURL(p.objectURL),this.demuxer=new i.default(f,h,c,v),this.w=void 0}}else this.demuxer=new i.default(f,h,c,v)}return n(t,[{key:"destroy",value:function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var r=this.observer;r&&(r.removeAllListeners(),this.observer=null)}},{key:"push",value:function(e,t,r,n,a,i,o,u){var l=this.w,f=isNaN(a.startDTS)?a.start:a.startDTS,c=a.decryptdata,d=this.frag,h=!(d&&a.cc===d.cc),v=!(d&&a.level===d.level),p=d&&a.sn===d.sn+1,g=!v&&p;if(h&&s.logger.log(this.id+":discontinuity detected"),v&&s.logger.log(this.id+":switch detected"),this.frag=a,l)l.postMessage({cmd:"demux",data:e,decryptdata:c,initSegment:t,audioCodec:r,videoCodec:n,timeOffset:f,discontinuity:h,trackSwitch:v,contiguous:g,duration:i,accurateTimeOffset:o,defaultInitPTS:u},[e]);else{var y=this.demuxer;y&&y.push(e,c,t,r,n,f,h,v,g,i,o,u)}}},{key:"onWorkerMessage",value:function(e){var t=e.data,r=this.hls;switch(t.event){case"init":URL.revokeObjectURL(this.w.objectURL);break;case a.default.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,r.trigger(t.event,t.data)}}}]),t}();r.default=c},{1:1,18:18,19:19,28:28,3:3,30:30,46:46}],21:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e(46),i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}return n(e,[{key:"loadWord",value:function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,n=new Uint8Array(4),a=Math.min(4,t);if(0===a)throw new Error("no bytes available");n.set(e.subarray(r,r+a)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*a,this.bytesAvailable-=a}},{key:"skipBits",value:function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}},{key:"readBits",value:function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;return e>32&&a.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),(t=e-t)>0&&this.bitsAvailable?r<<t|this.readBits(t):r}},{key:"skipLZ",value:function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var e=this.skipLZ();return this.readBits(e+1)-1}},{key:"readEG",value:function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}},{key:"readBoolean",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}},{key:"skipScalingList",value:function(e){var t,r=8,n=8;for(t=0;t<e;t++)0!==n&&(n=(r+this.readEG()+256)%256),r=0===n?r:n}},{key:"readSPS",value:function(){var e,t,r,n,a,i,o,s=0,u=0,l=0,f=0,c=this.readUByte.bind(this),d=this.readBits.bind(this),h=this.readUEG.bind(this),v=this.readBoolean.bind(this),p=this.skipBits.bind(this),g=this.skipEG.bind(this),y=this.skipUEG.bind(this),m=this.skipScalingList.bind(this);if(c(),e=c(),d(5),p(3),c(),y(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var b=h();if(3===b&&p(1),y(),y(),p(1),v())for(i=3!==b?8:12,o=0;o<i;o++)v()&&m(o<6?16:64)}y();var E=h();if(0===E)h();else if(1===E)for(p(1),g(),g(),t=h(),o=0;o<t;o++)g();y(),p(1),r=h(),n=h(),0===(a=d(1))&&p(1),p(1),v()&&(s=h(),u=h(),l=h(),f=h());var _=[1,1];if(v()&&v())switch(c()){case 1:_=[1,1];break;case 2:_=[12,11];break;case 3:_=[10,11];break;case 4:_=[16,11];break;case 5:_=[40,33];break;case 6:_=[24,11];break;case 7:_=[20,11];break;case 8:_=[32,11];break;case 9:_=[80,33];break;case 10:_=[18,11];break;case 11:_=[15,11];break;case 12:_=[64,33];break;case 13:_=[160,99];break;case 14:_=[4,3];break;case 15:_=[3,2];break;case 16:_=[2,1];break;case 255:_=[c()<<8|c(),c()<<8|c()]}return{width:Math.ceil(16*(r+1)-2*s-2*u),height:(2-a)*(n+1)*16-(a?2:4)*(l+f),pixelRatio:_}}},{key:"readSliceType",value:function(){return this.readUByte(),this.readUEG(),this.readUEG()}}]),e}();r.default=i},{46:46}],22:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,null,[{key:"isHeader",value:function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}},{key:"isFooter",value:function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}},{key:"getID3Data",value:function(t,r){for(var n=r,a=0;e.isHeader(t,r);)a+=10,a+=e._readSize(t,r+6),e.isFooter(t,r+10)&&(a+=10),r+=a;if(a>0)return t.subarray(n,n+a)}},{key:"_readSize",value:function(e,t){var r=0;return r=(127&e[t])<<21,r|=(127&e[t+1])<<14,r|=(127&e[t+2])<<7,r|=127&e[t+3]}},{key:"getTimeStamp",value:function(t){for(var r=e.getID3Frames(t),n=0;n<r.length;n++){var a=r[n];if(e.isTimeStampFrame(a))return e._readTimeStamp(a)}}},{key:"isTimeStampFrame",value:function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info}},{key:"_getFrameData",value:function(t){var r=String.fromCharCode(t[0],t[1],t[2],t[3]),n=e._readSize(t,4);return{type:r,size:n,data:t.subarray(10,10+n)}}},{key:"getID3Frames",value:function(t){for(var r=0,n=[];e.isHeader(t,r);){for(var a=e._readSize(t,r+6),i=(r+=10)+a;r+8<i;){var o=e._getFrameData(t.subarray(r)),s=e._decodeFrame(o);s&&n.push(s),r+=o.size+10}e.isFooter(t,r)&&(r+=10)}return n}},{key:"_decodeFrame",value:function(t){return"PRIV"===t.type?e._decodePrivFrame(t):"T"===t.type[0]?e._decodeTextFrame(t):"W"===t.type[0]?e._decodeURLFrame(t):void 0}},{key:"_readTimeStamp",value:function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),r=1&t[3],n=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return n/=45,r&&(n+=47721858.84),Math.round(n)}}},{key:"_decodePrivFrame",value:function(t){if(!(t.size<2)){var r=e._utf8ArrayToStr(t.data),n=new Uint8Array(t.data.subarray(r.length+1));return{key:t.type,info:r,data:n.buffer}}}},{key:"_decodeTextFrame",value:function(t){if(!(t.size<2)){if("TXXX"===t.type){var r=1,n=e._utf8ArrayToStr(t.data.subarray(r));r+=n.length+1;var a=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:n,data:a}}var i=e._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:i}}}},{key:"_decodeURLFrame",value:function(t){if("WXXX"===t.type){if(t.size<2)return;var r=1,n=e._utf8ArrayToStr(t.data.subarray(r));r+=n.length+1;var a=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:n,data:a}}var i=e._utf8ArrayToStr(t.data);return{key:t.type,data:i}}},{key:"_utf8ArrayToStr",value:function(e){for(var t=void 0,r=void 0,n="",a=0,i=e.length;a<i;){var o=e[a++];switch(o>>4){case 0:return n;case 1:case 2:case 3:case 4:case 5:case 6:case 7:n+=String.fromCharCode(o);break;case 12:case 13:t=e[a++],n+=String.fromCharCode((31&o)<<6|63&t);break;case 14:t=e[a++],r=e[a++],n+=String.fromCharCode((15&o)<<12|(63&t)<<6|(63&r)<<0)}}return n}}]),e}();r.default=a},{}],23:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=s(e(22)),i=e(46),o=s(e(25));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=n,this.remuxer=r}return n(e,[{key:"resetInitSegment",value:function(e,t,r,n){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:n,inputTimeScale:9e4}}},{key:"resetTimeStamp",value:function(){}},{key:"append",value:function(e,t,r,n){for(var i=a.default.getID3Data(e,0),s=90*a.default.getTimeStamp(i),u=i.length,l=e.length,f=0,c=0,d=this._audioTrack,h=[{pts:s,dts:s,data:i}];u<l;)if(o.default.isHeader(e,u)){var v=o.default.appendFrame(d,e,u,s,f);if(!v)break;u+=v.length,c=v.sample.pts,f++}else a.default.isHeader(e,u)?(i=a.default.getID3Data(e,u),h.push({pts:c,dts:c,data:i}),u+=i.length):u++;this.remuxer.remux(d,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},t,r,n)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(e){var t,r,n=a.default.getID3Data(e,0);if(n&&void 0!==a.default.getTimeStamp(n))for(t=n.length,r=Math.min(e.length-1,t+100);t<r;t++)if(o.default.probe(e,t))return i.logger.log("MPEG Audio sync word found !"),!0;return!1}}]),e}();r.default=u},{22:22,25:25,46:46}],24:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(30),o=(n=i)&&n.__esModule?n:{default:n},s=Math.pow(2,32)-1,u=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.remuxer=r}return a(e,[{key:"resetTimeStamp",value:function(e){this.initPTS=e}},{key:"resetInitSegment",value:function(t,r,n,a){if(t&&t.byteLength){var i=this.initData=e.parseInitSegment(t),s={};i.audio&&(s.audio={container:"audio/mp4",codec:r,initSegment:a?t:null}),i.video&&(s.video={container:"video/mp4",codec:n,initSegment:a?t:null}),this.observer.trigger(o.default.FRAG_PARSING_INIT_SEGMENT,{tracks:s})}else r&&(this.audioCodec=r),n&&(this.videoCodec=n)}},{key:"append",value:function(t,r,n,a){var i=this.initData;i||(this.resetInitSegment(t,this.audioCodec,this.videoCodec),i=this.initData);var s,u=this.initPTS;if(void 0===u){var l=e.getStartDTS(i,t);this.initPTS=u=l-r,this.observer.trigger(o.default.INIT_PTS_FOUND,{initPTS:u})}e.offsetStartDTS(i,t,u),s=e.getStartDTS(i,t),this.remuxer.remux(i.audio,i.video,null,null,s,n,a,t)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(t){if(t.length>=8){var r=e.bin2str(t.subarray(4,8));return["moof","ftyp","styp"].indexOf(r)>=0}return!1}},{key:"bin2str",value:function(e){return String.fromCharCode.apply(null,e)}},{key:"readUint32",value:function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return r<0?4294967296+r:r}},{key:"writeUint32",value:function(e,t,r){e.data&&(t+=e.start,e=e.data),e[t]=r>>24,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r}},{key:"findBox",value:function(t,r){var n,a,i,o,s,u,l=[];if(t.data?(s=t.start,i=t.end,t=t.data):(s=0,i=t.byteLength),!r.length)return null;for(n=s;n<i;)u=(a=e.readUint32(t,n))>1?n+a:i,e.bin2str(t.subarray(n+4,n+8))===r[0]&&(1===r.length?l.push({data:t,start:n+8,end:u}):(o=e.findBox({data:t,start:n+8,end:u},r.slice(1))).length&&(l=l.concat(o))),n=u;return l}},{key:"parseInitSegment",value:function(t){var r=[];return e.findBox(t,["moov","trak"]).forEach((function(t){var n=e.findBox(t,["tkhd"])[0];if(n){var a=n.data[n.start],i=0===a?12:20,o=e.readUint32(n,i),s=e.findBox(t,["mdia","mdhd"])[0];if(s){i=0===(a=s.data[s.start])?12:20;var u=e.readUint32(s,i),l=e.findBox(t,["mdia","hdlr"])[0];if(l){var f={soun:"audio",vide:"video"}[e.bin2str(l.data.subarray(l.start+8,l.start+12))];f&&(r[o]={timescale:u,type:f},r[f]={timescale:u,id:o})}}}})),r}},{key:"getStartDTS",value:function(t,r){var n,a,i;return n=e.findBox(r,["moof","traf"]),a=[].concat.apply([],n.map((function(r){return e.findBox(r,["tfhd"]).map((function(n){var a,i;return a=e.readUint32(n,4),i=t[a].timescale||9e4,(e.findBox(r,["tfdt"]).map((function(t){var r,n;return r=t.data[t.start],n=e.readUint32(t,4),1===r&&(n*=Math.pow(2,32),n+=e.readUint32(t,8)),n}))[0]||1/0)/i}))}))),i=Math.min.apply(null,a),isFinite(i)?i:0}},{key:"offsetStartDTS",value:function(t,r,n){e.findBox(r,["moof","traf"]).map((function(r){return e.findBox(r,["tfhd"]).map((function(a){var i=e.readUint32(a,4),o=t[i].timescale||9e4;e.findBox(r,["tfdt"]).map((function(t){var r=t.data[t.start],a=e.readUint32(t,4);if(0===r)e.writeUint32(t,4,a-n*o);else{a*=Math.pow(2,32),a+=e.readUint32(t,8),a-=n*o;var i=Math.floor(a/(s+1)),u=Math.floor(a%(s+1));e.writeUint32(t,4,i),e.writeUint32(t,8,u)}}))}))}))}}]),e}();r.default=u},{30:30}],25:[function(e,t,r){"use strict";var n={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],appendFrame:function(e,t,r,n,a){if(!(r+24>t.length)){var i=this.parseHeader(t,r);if(i&&r+i.frameLength<=t.length){var o=n+a*(10368e4/i.sampleRate),s={unit:t.subarray(r,r+i.frameLength),pts:o,dts:o};return e.config=[],e.channelCount=i.channelCount,e.samplerate=i.sampleRate,e.samples.push(s),e.len+=i.frameLength,{sample:s,length:i.frameLength}}}},parseHeader:function(e,t){var r=e[t+1]>>3&3,a=e[t+1]>>1&3,i=e[t+2]>>4&15,o=e[t+2]>>2&3,s=!!(2&e[t+2]);if(1!==r&&0!==i&&15!==i&&3!==o){var u=3===r?3-a:3===a?3:4,l=1e3*n.BitratesMap[14*u+i-1],f=3===r?0:2===r?1:2,c=n.SamplingRateMap[3*f+o],d=s?1:0;return{sampleRate:c,channelCount:e[t+3]>>6==3?1:2,frameLength:3===a?(3===r?12:6)*l/c+d<<2:(3===r?144:72)*l/c+d|0}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var r=this.parseHeader(e,t),n=4;r&&r.frameLength&&(n=r.frameLength);var a=t+n;if(a===e.length||a+1<e.length&&this.isHeaderPattern(e,a))return!0}return!1}};t.exports=n},{}],26:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(14),o=(n=i)&&n.__esModule?n:{default:n},s=function(){function e(t,r,n,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.decryptdata=n,this.discardEPB=a,this.decrypter=new o.default(t,r)}return a(e,[{key:"decryptBuffer",value:function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)}},{key:"decryptAacSample",value:function(e,t,r,n){var a=e[t].unit,i=a.subarray(16,a.length-a.length%16),o=i.buffer.slice(i.byteOffset,i.byteOffset+i.length),s=this;this.decryptBuffer(o,(function(i){i=new Uint8Array(i),a.set(i,16),n||s.decryptAacSamples(e,t+1,r)}))}},{key:"decryptAacSamples",value:function(e,t,r){for(;;t++){if(t>=e.length)return void r();if(!(e[t].unit.length<32)){var n=this.decrypter.isSync();if(this.decryptAacSample(e,t,r,n),!n)return}}}},{key:"getAvcEncryptedData",value:function(e){for(var t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t),n=0,a=32;a<=e.length-16;a+=160,n+=16)r.set(e.subarray(a,a+16),n);return r}},{key:"getAvcDecryptedUnit",value:function(e,t){t=new Uint8Array(t);for(var r=0,n=32;n<=e.length-16;n+=160,r+=16)e.set(t.subarray(r,r+16),n);return e}},{key:"decryptAvcSample",value:function(e,t,r,n,a,i){var o=this.discardEPB(a.data),s=this.getAvcEncryptedData(o),u=this;this.decryptBuffer(s.buffer,(function(s){a.data=u.getAvcDecryptedUnit(o,s),i||u.decryptAvcSamples(e,t,r+1,n)}))}},{key:"decryptAvcSamples",value:function(e,t,r,n){for(;;t++,r=0){if(t>=e.length)return void n();for(var a=e[t].units;!(r>=a.length);r++){var i=a[r];if(!(i.length<=48||1!==i.type&&5!==i.type)){var o=this.decrypter.isSync();if(this.decryptAvcSample(e,t,r,n,i,o),!o)return}}}}}]),e}();r.default=s},{14:14}],27:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=c(e(17)),i=c(e(25)),o=c(e(30)),s=c(e(21)),u=c(e(26)),l=e(46),f=e(28);function c(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(t,r,n,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=n,this.typeSupported=a,this.remuxer=r,this.sampleAes=null}return n(e,[{key:"setDecryptData",value:function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new u.default(this.observer,this.config,e,this.discardEPB):this.sampleAes=null}},{key:"resetInitSegment",value:function(e,t,r,n){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack={container:"video/mp2t",type:"video",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:0},this._audioTrack={container:"video/mp2t",type:"audio",id:-1,inputTimeScale:9e4,duration:n,sequenceNumber:0,samples:[],len:0,isAAC:!0},this._id3Track={type:"id3",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0},this._txtTrack={type:"text",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0},this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=t,this.videoCodec=r,this._duration=n}},{key:"resetTimeStamp",value:function(){}},{key:"append",value:function(e,t,r,n){var a,i,s,u,c,d=e.length,h=!1;this.contiguous=r;var v=this.pmtParsed,p=this._avcTrack,g=this._audioTrack,y=this._id3Track,m=p.id,b=g.id,E=y.id,_=this._pmtId,T=p.pesData,A=g.pesData,S=y.pesData,k=this._parsePAT,w=this._parsePMT,R=this._parsePES,L=this._parseAVCPES.bind(this),x=this._parseAACPES.bind(this),O=this._parseMPEGPES.bind(this),D=this._parseID3PES.bind(this);for(d-=d%188,a=0;a<d;a+=188)if(71===e[a]){if(i=!!(64&e[a+1]),s=((31&e[a+1])<<8)+e[a+2],(48&e[a+3])>>4>1){if((u=a+5+e[a+4])===a+188)continue}else u=a+4;switch(s){case m:i&&(T&&(c=R(T))&&L(c,!1),T={data:[],size:0}),T&&(T.data.push(e.subarray(u,a+188)),T.size+=a+188-u);break;case b:i&&(A&&(c=R(A))&&(g.isAAC?x(c):O(c)),A={data:[],size:0}),A&&(A.data.push(e.subarray(u,a+188)),A.size+=a+188-u);break;case E:i&&(S&&(c=R(S))&&D(c),S={data:[],size:0}),S&&(S.data.push(e.subarray(u,a+188)),S.size+=a+188-u);break;case 0:i&&(u+=e[u]+1),_=this._pmtId=k(e,u);break;case _:i&&(u+=e[u]+1);var P=w(e,u,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);(m=P.avc)>0&&(p.id=m),(b=P.audio)>0&&(g.id=b,g.isAAC=P.isAAC),(E=P.id3)>0&&(y.id=E),h&&!v&&(l.logger.log("reparse from beginning"),h=!1,a=-188),v=this.pmtParsed=!0;break;case 17:case 8191:break;default:h=!0}}else this.observer.trigger(o.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});T&&(c=R(T))?(L(c,!0),p.pesData=null):p.pesData=T,A&&(c=R(A))?(g.isAAC?x(c):O(c),g.pesData=null):(A&&A.size&&l.logger.log("last AAC PES packet truncated,might overlap between fragments"),g.pesData=A),S&&(c=R(S))?(D(c),y.pesData=null):y.pesData=S,null==this.sampleAes?this.remuxer.remux(g,p,y,this._txtTrack,t,r,n):this.decryptAndRemux(g,p,y,this._txtTrack,t,r,n)}},{key:"decryptAndRemux",value:function(e,t,r,n,a,i,o){if(e.samples&&e.isAAC){var s=this;this.sampleAes.decryptAacSamples(e.samples,0,(function(){s.decryptAndRemuxAvc(e,t,r,n,a,i,o)}))}else this.decryptAndRemuxAvc(e,t,r,n,a,i,o)}},{key:"decryptAndRemuxAvc",value:function(e,t,r,n,a,i,o){if(t.samples){var s=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,(function(){s.remuxer.remux(e,t,r,n,a,i,o)}))}else this.remuxer.remux(e,t,r,n,a,i,o)}},{key:"destroy",value:function(){this._initPTS=this._initDTS=void 0,this._duration=0}},{key:"_parsePAT",value:function(e,t){return(31&e[t+10])<<8|e[t+11]}},{key:"_parsePMT",value:function(e,t,r,n){var a,i,o={audio:-1,avc:-1,id3:-1,isAAC:!0};for(a=t+3+((15&e[t+1])<<8|e[t+2])-4,t+=12+((15&e[t+10])<<8|e[t+11]);t<a;){switch(i=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!n){l.logger.log("unkown stream type:"+e[t]);break}case 15:-1===o.audio&&(o.audio=i);break;case 21:-1===o.id3&&(o.id3=i);break;case 219:if(!n){l.logger.log("unkown stream type:"+e[t]);break}case 27:-1===o.avc&&(o.avc=i);break;case 3:case 4:r?-1===o.audio&&(o.audio=i,o.isAAC=!1):l.logger.log("MPEG audio found, not supported in this browser for now");break;case 36:l.logger.warn("HEVC stream type found, not supported for now");break;default:l.logger.log("unkown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return o}},{key:"_parsePES",value:function(e){var t,r,n,a,i,o,s,u,f=0,c=e.data;if(!e||0===e.size)return null;for(;c[0].length<19&&c.length>1;){var d=new Uint8Array(c[0].length+c[1].length);d.set(c[0]),d.set(c[1],c[0].length),c[0]=d,c.splice(1,1)}if(1===((t=c[0])[0]<<16)+(t[1]<<8)+t[2]){if((n=(t[4]<<8)+t[5])&&n>e.size-6)return null;192&(r=t[7])&&((o=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2)>4294967295&&(o-=8589934592),64&r?((s=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>4294967295&&(s-=8589934592),o-s>54e5&&(l.logger.warn(Math.round((o-s)/9e4)+"s delta between PTS and DTS, align them"),o=s)):s=o),u=(a=t[8])+9,e.size-=u,i=new Uint8Array(e.size);for(var h=0,v=c.length;h<v;h++){var p=(t=c[h]).byteLength;if(u){if(u>p){u-=p;continue}t=t.subarray(u),p-=u,u=0}i.set(t,f),f+=p}return n&&(n-=a+3),{data:i,pts:o,dts:s,len:n}}return null}},{key:"pushAccesUnit",value:function(e,t){if(e.units.length&&e.frame){var r=t.samples,n=r.length;!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(n||this.contiguous)?(e.id=n,r.push(e)):t.dropped++}e.debug.length&&l.logger.log(e.pts+"/"+e.dts+":"+e.debug)}},{key:"_parseAVCPES",value:function(e,t){var r,n,a,i=this,o=this._avcTrack,u=this._parseAVCNALu(e.data),l=this.avcSample,f=!1,c=this.pushAccesUnit.bind(this),d=function(e,t,r,n){return{key:e,pts:t,dts:r,units:[],debug:n}};e.data=null,l&&u.length&&(c(l,o),l=this.avcSample=d(!1,e.pts,e.dts,"")),u.forEach((function(t){switch(t.type){case 1:n=!0,l.frame=!0;var u=t.data;if(f&&u.length>4){var h=new s.default(u).readSliceType();2!==h&&4!==h&&7!==h&&9!==h||(l.key=!0)}break;case 5:n=!0,l||(l=i.avcSample=d(!0,e.pts,e.dts,"")),l.key=!0,l.frame=!0;break;case 6:n=!0,(r=new s.default(i.discardEPB(t.data))).readUByte();for(var v=0,p=0,g=!1,y=0;!g&&r.bytesAvailable>1;){v=0;do{v+=y=r.readUByte()}while(255===y);p=0;do{p+=y=r.readUByte()}while(255===y);if(4===v&&0!==r.bytesAvailable){if(g=!0,181===r.readUByte()&&49===r.readUShort()&&1195456820===r.readUInt()&&3===r.readUByte()){var m=r.readUByte(),b=31&m,E=[m,r.readUByte()];for(a=0;a<b;a++)E.push(r.readUByte()),E.push(r.readUByte()),E.push(r.readUByte());i._insertSampleInOrder(i._txtTrack.samples,{type:3,pts:e.pts,bytes:E})}}else if(p<r.bytesAvailable)for(a=0;a<p;a++)r.readUByte()}break;case 7:if(n=!0,f=!0,!o.sps){var _=(r=new s.default(t.data)).readSPS();o.width=_.width,o.height=_.height,o.pixelRatio=_.pixelRatio,o.sps=[t.data],o.duration=i._duration;var T=t.data.subarray(1,4),A="avc1.";for(a=0;a<3;a++){var S=T[a].toString(16);S.length<2&&(S="0"+S),A+=S}o.codec=A}break;case 8:n=!0,o.pps||(o.pps=[t.data]);break;case 9:n=!1,l&&c(l,o),l=i.avcSample=d(!1,e.pts,e.dts,"");break;case 12:n=!1;break;default:n=!1,l&&(l.debug+="unknown NAL "+t.type+" ")}l&&n&&l.units.push(t)})),t&&l&&(c(l,o),this.avcSample=null)}},{key:"_insertSampleInOrder",value:function(e,t){var r=e.length;if(r>0){if(t.pts>=e[r-1].pts)e.push(t);else for(var n=r-1;n>=0;n--)if(t.pts<e[n].pts){e.splice(n,0,t);break}}else e.push(t)}},{key:"_getLastNalUnit",value:function(){var e=this.avcSample,t=void 0;if(!e||0===e.units.length){var r=this._avcTrack.samples;e=r[r.length-1]}if(e){var n=e.units;t=n[n.length-1]}return t}},{key:"_parseAVCNALu",value:function(e){var t,r,n,a,i=0,o=e.byteLength,s=this._avcTrack,u=s.naluState||0,l=u,f=[],c=-1;for(-1===u&&(c=0,a=31&e[0],u=0,i=1);i<o;)if(t=e[i++],u)if(1!==u)if(t)if(1===t){if(c>=0)n={data:e.subarray(c,i-u-1),type:a},f.push(n);else{var d=this._getLastNalUnit();if(d&&(l&&i<=4-l&&d.state&&(d.data=d.data.subarray(0,d.data.byteLength-l)),(r=i-u-1)>0)){var h=new Uint8Array(d.data.byteLength+r);h.set(d.data,0),h.set(e.subarray(0,r),d.data.byteLength),d.data=h}}i<o?(c=i,a=31&e[i],u=0):u=-1}else u=0;else u=3;else u=t?0:2;else u=t?0:1;if(c>=0&&u>=0&&(n={data:e.subarray(c,o),type:a,state:u},f.push(n)),0===f.length){var v=this._getLastNalUnit();if(v){var p=new Uint8Array(v.data.byteLength+e.byteLength);p.set(v.data,0),p.set(e,v.data.byteLength),v.data=p}}return s.naluState=u,f}},{key:"discardEPB",value:function(e){for(var t,r,n=e.byteLength,a=[],i=1;i<n-2;)0===e[i]&&0===e[i+1]&&3===e[i+2]?(a.push(i+2),i+=2):i++;if(0===a.length)return e;t=n-a.length,r=new Uint8Array(t);var o=0;for(i=0;i<t;o++,i++)o===a[0]&&(o++,a.shift()),r[i]=e[o];return r}},{key:"_parseAACPES",value:function(e){var t,r,n,i,s,u,c,d=this._audioTrack,h=e.data,v=e.pts,p=this.aacOverFlow,g=this.aacLastPTS;if(p){var y=new Uint8Array(p.byteLength+h.byteLength);y.set(p,0),y.set(h,p.byteLength),h=y}for(n=0,s=h.length;n<s-1&&!a.default.isHeader(h,n);n++);if(!n||(n<s-1?(u="AAC PES did not start with ADTS header,offset:"+n,c=!1):(u="no ADTS header found in AAC PES",c=!0),l.logger.warn("parsing error:"+u),this.observer.trigger(o.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_PARSING_ERROR,fatal:c,reason:u}),!c)){if(a.default.initTrackConfig(d,this.observer,h,n,this.audioCodec),r=0,t=a.default.getFrameDuration(d.samplerate),p&&g){var m=g+t;Math.abs(m-v)>1&&(l.logger.log("AAC: align PTS for overlapping frames by "+Math.round((m-v)/90)),v=m)}for(;n<s;)if(a.default.isHeader(h,n)&&n+5<s){var b=a.default.appendFrame(d,h,n,v,r);if(!b)break;n+=b.length,i=b.sample.pts,r++}else n++;p=n<s?h.subarray(n,s):null,this.aacOverFlow=p,this.aacLastPTS=i}}},{key:"_parseMPEGPES",value:function(e){for(var t=e.data,r=t.length,n=0,a=0,o=e.pts;a<r;)if(i.default.isHeader(t,a)){var s=i.default.appendFrame(this._audioTrack,t,a,o,n);if(!s)break;a+=s.length,n++}else a++}},{key:"_parseID3PES",value:function(e){this._id3Track.samples.push(e)}}],[{key:"probe",value:function(e){return e.length>=564&&71===e[0]&&71===e[188]&&71===e[376]}}]),e}();r.default=d},{17:17,21:21,25:25,26:26,28:28,30:30,46:46}],28:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},r.ErrorDetails={MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOOP_LOADING_ERROR:"fragLoopLoadingError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException",WEBVTT_EXCEPTION:"webVTTException"}},{}],29:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=e(46),s=e(28),u=e(30),l=(n=u)&&n.__esModule?n:{default:n};function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var c=function(){function e(t){f(this,e),this.hls=t,this.onEvent=this.onEvent.bind(this);for(var r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];this.handledEvents=n,this.useGenericHandler=!0,this.registerListeners()}return i(e,[{key:"destroy",value:function(){this.unregisterListeners()}},{key:"isEventHandler",value:function(){return"object"===a(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent}},{key:"registerListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach((function(e){if("hlsEventGeneric"===e)throw new Error("Forbidden event name: "+e);this.hls.on(e,this.onEvent)}),this)}},{key:"unregisterListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach((function(e){this.hls.off(e,this.onEvent)}),this)}},{key:"onEvent",value:function(e,t){this.onEventGeneric(e,t)}},{key:"onEventGeneric",value:function(e,t){try{(function(e,t){var r="on"+e.replace("hls","");if("function"!=typeof this[r])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+r+")");return this[r].bind(this,t)}).call(this,e,t).call()}catch(t){o.logger.error("internal error happened while processing "+e+":"+t.message),this.hls.trigger(l.default.ERROR,{type:s.ErrorTypes.OTHER_ERROR,details:s.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}}}]),e}();r.default=c},{28:28,30:30,46:46}],30:[function(e,t,r){"use strict";t.exports={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCH:"hlsLevelSwitch",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCH:"hlsAudioTrackSwitch",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},{}],31:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,null,[{key:"getSilentFrame",value:function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}}]),e}();r.default=a},{}],32:[function(e,t,r){"use strict";var n={isBuffered:function(e,t){if(e)for(var r=e.buffered,n=0;n<r.length;n++)if(t>=r.start(n)&&t<=r.end(n))return!0;return!1},bufferInfo:function(e,t,r){if(e){var n,a=e.buffered,i=[];for(n=0;n<a.length;n++)i.push({start:a.start(n),end:a.end(n)});return this.bufferedInfo(i,t,r)}return{len:0,start:t,end:t,nextStart:void 0}},bufferedInfo:function(e,t,r){var n,a,i,o,s,u=[];for(e.sort((function(e,t){var r=e.start-t.start;return r||t.end-e.end})),s=0;s<e.length;s++){var l=u.length;if(l){var f=u[l-1].end;e[s].start-f<r?e[s].end>f&&(u[l-1].end=e[s].end):u.push(e[s])}else u.push(e[s])}for(s=0,n=0,a=i=t;s<u.length;s++){var c=u[s].start,d=u[s].end;if(t+r>=c&&t<d)a=c,n=(i=d)-t;else if(t+r<c){o=c;break}}return{len:n,start:a,end:i,nextStart:o}}};t.exports=n},{}],33:[function(e,t,r){"use strict";var n=e(46),a={mergeDetails:function(e,t){var r,i=Math.max(e.startSN,t.startSN)-t.startSN,o=Math.min(e.endSN,t.endSN)-t.startSN,s=t.startSN-e.startSN,u=e.fragments,l=t.fragments,f=0;if(o<i)t.PTSKnown=!1;else{for(var c=i;c<=o;c++){var d=u[s+c],h=l[c];h&&d&&(f=d.cc-h.cc,isNaN(d.startPTS)||(h.start=h.startPTS=d.startPTS,h.endPTS=d.endPTS,h.duration=d.duration,h.backtracked=d.backtracked,h.dropped=d.dropped,r=h))}if(f)for(n.logger.log("discontinuity sliding from playlist, take drift into account"),c=0;c<l.length;c++)l[c].cc+=f;if(r)a.updateFragPTSDTS(t,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS);else if(s>=0&&s<u.length){var v=u[s].start;for(c=0;c<l.length;c++)l[c].start+=v}t.PTSKnown=e.PTSKnown}},updateFragPTSDTS:function(e,t,r,n,i,o){var s=r;if(!isNaN(t.startPTS)){var u=Math.abs(t.startPTS-r);isNaN(t.deltaPTS)?t.deltaPTS=u:t.deltaPTS=Math.max(u,t.deltaPTS),s=Math.max(r,t.startPTS),r=Math.min(r,t.startPTS),n=Math.max(n,t.endPTS),i=Math.min(i,t.startDTS),o=Math.max(o,t.endDTS)}var l=r-t.start;t.start=t.startPTS=r,t.maxStartPTS=s,t.endPTS=n,t.startDTS=i,t.endDTS=o,t.duration=n-r;var f,c,d,h=t.sn;if(!e||h<e.startSN||h>e.endSN)return 0;for(f=h-e.startSN,(c=e.fragments)[f]=t,d=f;d>0;d--)a.updatePTS(c,d,d-1);for(d=f;d<c.length-1;d++)a.updatePTS(c,d,d+1);return e.PTSKnown=!0,l},updatePTS:function(e,t,r){var a=e[t],i=e[r],o=i.startPTS;isNaN(o)?i.start=r>t?a.start+a.duration:Math.max(a.start-i.duration,0):r>t?(a.duration=o-a.start,a.duration<0&&n.logger.warn("negative duration computed for frag "+a.sn+",level "+a.level+", there should be some duration drift between playlist and fragment!")):(i.duration=a.start-o,i.duration<0&&n.logger.warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!"))}};t.exports=a},{46:46}],34:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=g(e(2)),i=g(e(30)),o=e(28),s=g(e(38)),u=g(e(36)),l=g(e(37)),f=g(e(11)),c=g(e(10)),d=g(e(9)),h=e(46),v=g(e(1)),p=e(4);function g(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var m=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y(this,e);var n=e.DefaultConfig;if((r.liveSyncDurationCount||r.liveMaxLatencyDurationCount)&&(r.liveSyncDuration||r.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var a in n)a in r||(r[a]=n[a]);if(void 0!==r.liveMaxLatencyDurationCount&&r.liveMaxLatencyDurationCount<=r.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==r.liveMaxLatencyDuration&&(r.liveMaxLatencyDuration<=r.liveSyncDuration||void 0===r.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');(0,h.enableLogs)(r.debug),this.config=r,this._autoLevelCapping=-1;var i=this.observer=new v.default;i.trigger=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];i.emit.apply(i,[e,e].concat(r))},i.off=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];i.removeListener.apply(i,[e].concat(r))},this.on=i.on.bind(i),this.off=i.off.bind(i),this.trigger=i.trigger.bind(i);var o=this.abrController=new r.abrController(this),p=new r.bufferController(this),g=new r.capLevelController(this),m=new r.fpsController(this),b=new s.default(this),E=new u.default(this),_=new l.default(this),T=new d.default(this),A=this.levelController=new c.default(this),S=this.streamController=new f.default(this),k=[A,S],w=r.audioStreamController;w&&k.push(new w(this)),this.networkControllers=k;var R=[b,E,_,o,p,g,m,T];if(w=r.audioTrackController){var L=new w(this);this.audioTrackController=L,R.push(L)}if(w=r.subtitleTrackController){var x=new w(this);this.subtitleTrackController=x,R.push(x)}[r.subtitleStreamController,r.timelineController].forEach((function(e){e&&R.push(new e(t))})),this.coreComponents=R}return n(e,null,[{key:"isSupported",value:function(){var e=window.MediaSource=window.MediaSource||window.WebKitMediaSource,t=window.SourceBuffer=window.SourceBuffer||window.WebKitSourceBuffer,r=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return r&&n}},{key:"version",get:function(){return"0.7.11"}},{key:"Events",get:function(){return i.default}},{key:"ErrorTypes",get:function(){return o.ErrorTypes}},{key:"ErrorDetails",get:function(){return o.ErrorDetails}},{key:"DefaultConfig",get:function(){return e.defaultConfig?e.defaultConfig:p.hlsDefaultConfig},set:function(t){e.defaultConfig=t}}]),n(e,[{key:"destroy",value:function(){h.logger.log("destroy"),this.trigger(i.default.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach((function(e){e.destroy()})),this.url=null,this.observer.removeAllListeners(),this._autoLevelCapping=-1}},{key:"attachMedia",value:function(e){h.logger.log("attachMedia"),this.media=e,this.trigger(i.default.MEDIA_ATTACHING,{media:e})}},{key:"detachMedia",value:function(){h.logger.log("detachMedia"),this.trigger(i.default.MEDIA_DETACHING),this.media=null}},{key:"loadSource",value:function(e){e=a.default.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),h.logger.log("loadSource:"+e),this.url=e,this.trigger(i.default.MANIFEST_LOADING,{url:e})}},{key:"startLoad",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;h.logger.log("startLoad("+e+")"),this.networkControllers.forEach((function(t){t.startLoad(e)}))}},{key:"stopLoad",value:function(){h.logger.log("stopLoad"),this.networkControllers.forEach((function(e){e.stopLoad()}))}},{key:"swapAudioCodec",value:function(){h.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}},{key:"recoverMediaError",value:function(){h.logger.log("recoverMediaError");var e=this.media;this.detachMedia(),this.attachMedia(e)}},{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){h.logger.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){h.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){h.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){h.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){h.logger.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){h.logger.log("set autoLevelCapping:"+e),this._autoLevelCapping=e}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,r=e?e.length:0,n=0;n<r;n++)if((e[n].realBitrate?Math.max(e[n].realBitrate,e[n].bitrate):e[n].bitrate)>t)return n;return 0}},{key:"maxAutoLevel",get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}}]),e}();r.default=m},{1:1,10:10,11:11,2:2,28:28,30:30,36:36,37:37,38:38,4:4,46:46,9:9}],35:[function(e,t,r){"use strict";t.exports=e(34).default},{34:34}],36:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=u(e(30)),i=u(e(29)),o=e(28),s=e(46);function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.FRAG_LOADING));return r.loaders={},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){var e=this.loaders;for(var t in e){var r=e[t];r&&r.destroy()}this.loaders={},i.default.prototype.destroy.call(this)}},{key:"onFragLoading",value:function(e){var t=e.frag,r=t.type,n=this.loaders[r],a=this.hls.config;t.loaded=0,n&&(s.logger.warn("abort previous fragment loader for type:"+r),n.abort()),n=this.loaders[r]=t.loader=void 0!==a.fLoader?new a.fLoader(a):new a.loader(a);var i,o,u=void 0;u={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var l=t.byteRangeStartOffset,f=t.byteRangeEndOffset;isNaN(l)||isNaN(f)||(u.rangeStart=l,u.rangeEnd=f),i={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:a.fragLoadingMaxRetryTimeout},o={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},n.load(u,i,o)}},{key:"loadsuccess",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=e.data,o=r.frag;o.loader=void 0,this.loaders[o.type]=void 0,this.hls.trigger(a.default.FRAG_LOADED,{payload:i,frag:o,stats:t,networkDetails:n})}},{key:"loaderror",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=t.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:r})}},{key:"loadtimeout",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=t.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:r})}},{key:"loadprogress",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=t.frag;i.loaded=e.loaded,this.hls.trigger(a.default.FRAG_LOAD_PROGRESS,{frag:i,stats:e,networkDetails:n})}}]),t}(i.default);r.default=l},{28:28,29:29,30:30,46:46}],37:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=u(e(30)),i=u(e(29)),o=e(28),s=e(46);function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.KEY_LOADING));return r.loaders={},r.decryptkey=null,r.decrypturl=null,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},i.default.prototype.destroy.call(this)}},{key:"onKeyLoading",value:function(e){var t=e.frag,r=t.type,n=this.loaders[r],i=t.decryptdata,o=i.uri;if(o!==this.decrypturl||null===this.decryptkey){var u,l,f,c=this.hls.config;n&&(s.logger.warn("abort previous key loader for type:"+r),n.abort()),t.loader=this.loaders[r]=new c.loader(c),this.decrypturl=o,this.decryptkey=null,u={url:o,frag:t,responseType:"arraybuffer"},l={timeout:c.fragLoadingTimeOut,maxRetry:c.fragLoadingMaxRetry,retryDelay:c.fragLoadingRetryDelay,maxRetryDelay:c.fragLoadingMaxRetryTimeout},f={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},t.loader.load(u,l,f)}else this.decryptkey&&(i.key=this.decryptkey,this.hls.trigger(a.default.KEY_LOADED,{frag:t}))}},{key:"loadsuccess",value:function(e,t,r){var n=r.frag;this.decryptkey=n.decryptdata.key=new Uint8Array(e.data),n.loader=void 0,this.loaders[n.type]=void 0,this.hls.trigger(a.default.KEY_LOADED,{frag:n})}},{key:"loaderror",value:function(e,t){var r=t.frag,n=r.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:r,response:e})}},{key:"loadtimeout",value:function(e,t){var r=t.frag,n=r.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:r})}}]),t}(i.default);r.default=l},{28:28,29:29,30:30,46:46}],38:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=f(e(2)),i=f(e(30)),o=f(e(29)),s=e(28),u=f(e(42)),l=e(46);function f(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var d=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,h=/#EXT-X-MEDIA:(.*)/g,v=new RegExp([/#EXTINF:(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)(\S+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),p=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,g=function(){function e(){c(this,e),this.method=null,this.key=null,this.iv=null,this._uri=null}return n(e,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=a.default.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}]),e}(),y=function(){function e(){c(this,e),this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[]}return n(e,[{key:"createInitializationVector",value:function(e){for(var t=new Uint8Array(16),r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t}},{key:"fragmentDecryptdataFromLevelkey",value:function(e,t){var r=e;return e&&e.method&&e.uri&&!e.iv&&((r=new g).method=e.method,r.baseuri=e.baseuri,r.reluri=e.reluri,r.iv=this.createInitializationVector(t)),r}},{key:"cloneObj",value:function(e){return JSON.parse(JSON.stringify(e))}},{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=a.default.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e}},{key:"programDateTime",get:function(){return!this._programDateTime&&this.rawProgramDateTime&&(this._programDateTime=new Date(Date.parse(this.rawProgramDateTime))),this._programDateTime}},{key:"byteRange",get:function(){if(!this._byteRange){var e=this._byteRange=[];if(this.rawByteRange){var t=this.rawByteRange.split("@",2);if(1===t.length){var r=this.lastByteRangeEndOffset;e[0]=r||0}else e[0]=parseInt(t[1]);e[1]=parseInt(t[0])+e[0]}}return this._byteRange}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata}}]),e}(),m=function(e){function t(e){c(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i.default.MANIFEST_LOADING,i.default.LEVEL_LOADING,i.default.AUDIO_TRACK_LOADING,i.default.SUBTITLE_TRACK_LOADING));return r.loaders={},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},o.default.prototype.destroy.call(this)}},{key:"onManifestLoading",value:function(e){this.load(e.url,{type:"manifest"})}},{key:"onLevelLoading",value:function(e){this.load(e.url,{type:"level",level:e.level,id:e.id})}},{key:"onAudioTrackLoading",value:function(e){this.load(e.url,{type:"audioTrack",id:e.id})}},{key:"onSubtitleTrackLoading",value:function(e){this.load(e.url,{type:"subtitleTrack",id:e.id})}},{key:"load",value:function(e,t){var r=this.loaders[t.type];if(r){var n=r.context;if(n&&n.url===e)return void l.logger.trace("playlist request ongoing");l.logger.warn("abort previous loader for type:"+t.type),r.abort()}var a,i,o=this.hls.config,s=void 0,u=void 0,f=void 0,c=void 0;"manifest"===t.type?(s=o.manifestLoadingMaxRetry,u=o.manifestLoadingTimeOut,f=o.manifestLoadingRetryDelay,c=o.manifestLoadingMaxRetryTimeout):(s=o.levelLoadingMaxRetry,u=o.levelLoadingTimeOut,f=o.levelLoadingRetryDelay,c=o.levelLoadingMaxRetryTimeout,l.logger.log("loading playlist for "+t.type+" "+(t.level||t.id))),r=this.loaders[t.type]=t.loader=void 0!==o.pLoader?new o.pLoader(o):new o.loader(o),t.url=e,t.responseType="",a={timeout:u,maxRetry:s,retryDelay:f,maxRetryDelay:c},i={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},r.load(t,a,i)}},{key:"resolve",value:function(e,t){return a.default.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}},{key:"parseMasterPlaylist",value:function(e,t){var r=[],n=void 0;for(d.lastIndex=0;null!=(n=d.exec(e));){var a={},i=a.attrs=new u.default(n[1]);a.url=this.resolve(n[2],t);var o=i.decimalResolution("RESOLUTION");o&&(a.width=o.width,a.height=o.height),a.bitrate=i.decimalInteger("AVERAGE-BANDWIDTH")||i.decimalInteger("BANDWIDTH"),a.name=i.NAME;var s=i.CODECS;if(s){s=s.split(/[ ,]+/);for(var l=0;l<s.length;l++){var f=s[l];-1!==f.indexOf("avc1")?a.videoCodec=this.avc1toavcoti(f):-1!==f.indexOf("hvc1")?a.videoCodec=f:a.audioCodec=f}}r.push(a)}return r}},{key:"parseMasterPlaylistMedia",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=void 0,i=[],o=0;for(h.lastIndex=0;null!=(a=h.exec(e));){var s={},l=new u.default(a[1]);l.TYPE===r&&(s.groupId=l["GROUP-ID"],s.name=l.NAME,s.type=r,s.default="YES"===l.DEFAULT,s.autoselect="YES"===l.AUTOSELECT,s.forced="YES"===l.FORCED,l.URI&&(s.url=this.resolve(l.URI,t)),s.lang=l.LANGUAGE,s.name||(s.name=s.lang),n&&(s.audioCodec=n),s.id=o++,i.push(s))}return i}},{key:"avc1toavcoti",value:function(e){var t,r=e.split(".");return r.length>2?(t=r.shift()+".",t+=parseInt(r.shift()).toString(16),t+=("000"+parseInt(r.shift()).toString(16)).substr(-4)):t=e,t}},{key:"parseLevelPlaylist",value:function(e,t,r,n){var a,i,o=0,s=0,f={type:null,version:null,url:t,fragments:[],live:!0,startSN:0},c=new g,d=0,h=null,m=new y;for(v.lastIndex=0;null!==(a=v.exec(e));){var b=a[1];if(b){m.duration=parseFloat(b);var E=(" "+a[2]).slice(1);m.title=E||null,m.tagList.push(E?["INF",b,E]:["INF",b])}else if(a[3]){if(!isNaN(m.duration)){var _=o++;m.type=n,m.start=s,m.levelkey=c,m.sn=_,m.level=r,m.cc=d,m.baseurl=t,m.relurl=(" "+a[3]).slice(1),f.fragments.push(m),h=m,s+=m.duration,m=new y}}else if(a[4]){if(m.rawByteRange=(" "+a[4]).slice(1),h){var T=h.byteRangeEndOffset;T&&(m.lastByteRangeEndOffset=T)}}else if(a[5])m.rawProgramDateTime=(" "+a[5]).slice(1),m.tagList.push(["PROGRAM-DATE-TIME",m.rawProgramDateTime]);else{for(a=a[0].match(p),i=1;i<a.length&&void 0===a[i];i++);var A=(" "+a[i+1]).slice(1),S=(" "+a[i+2]).slice(1);switch(a[i]){case"#":m.tagList.push(S?[A,S]:[A]);break;case"PLAYLIST-TYPE":f.type=A.toUpperCase();break;case"MEDIA-SEQUENCE":o=f.startSN=parseInt(A);break;case"TARGETDURATION":f.targetduration=parseFloat(A);break;case"VERSION":f.version=parseInt(A);break;case"EXTM3U":break;case"ENDLIST":f.live=!1;break;case"DIS":d++,m.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":d=parseInt(A);break;case"KEY":var k=A,w=new u.default(k),R=w.enumeratedString("METHOD"),L=w.URI,x=w.hexadecimalInteger("IV");R&&(c=new g,L&&["AES-128","SAMPLE-AES"].indexOf(R)>=0&&(c.method=R,c.baseuri=t,c.reluri=L,c.key=null,c.iv=x));break;case"START":var O=A,D=new u.default(O).decimalFloatingPoint("TIME-OFFSET");isNaN(D)||(f.startTimeOffset=D);break;case"MAP":var P=new u.default(A);m.relurl=P.URI,m.rawByteRange=P.BYTERANGE,m.baseurl=t,m.level=r,m.type=n,m.sn="initSegment",f.initSegment=m,m=new y;break;default:l.logger.warn("line parsed but not handled: "+a)}}}return(m=h)&&!m.relurl&&(f.fragments.pop(),s-=m.duration),f.totalduration=s,f.averagetargetduration=s/f.fragments.length,f.endSN=o-1,f}},{key:"loadsuccess",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=e.data,o=e.url,u=r.type,f=r.id,c=r.level,d=this.hls;if(this.loaders[u]=void 0,void 0!==o&&0!==o.indexOf("data:")||(o=r.url),t.tload=performance.now(),0===a.indexOf("#EXTM3U"))if(a.indexOf("#EXTINF:")>0){var h="audioTrack"!==u&&"subtitleTrack"!==u,v=isNaN(c)?isNaN(f)?0:f:c,p=this.parseLevelPlaylist(a,o,v,"audioTrack"===u?"audio":"subtitleTrack"===u?"subtitle":"main");p.tload=t.tload,"manifest"===u&&d.trigger(i.default.MANIFEST_LOADED,{levels:[{url:o,details:p}],audioTracks:[],url:o,stats:t,networkDetails:n}),t.tparsed=performance.now(),p.targetduration?h?d.trigger(i.default.LEVEL_LOADED,{details:p,level:c||0,id:f||0,stats:t,networkDetails:n}):"audioTrack"===u?d.trigger(i.default.AUDIO_TRACK_LOADED,{details:p,id:f,stats:t,networkDetails:n}):"subtitleTrack"===u&&d.trigger(i.default.SUBTITLE_TRACK_LOADED,{details:p,id:f,stats:t,networkDetails:n}):d.trigger(i.default.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:o,reason:"invalid targetduration",networkDetails:n})}else{var g=this.parseMasterPlaylist(a,o);if(g.length){var y=this.parseMasterPlaylistMedia(a,o,"AUDIO",g[0].audioCodec),m=this.parseMasterPlaylistMedia(a,o,"SUBTITLES");if(y.length){var b=!1;y.forEach((function(e){e.url||(b=!0)})),!1===b&&g[0].audioCodec&&!g[0].attrs.AUDIO&&(l.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),y.unshift({type:"main",name:"main"}))}d.trigger(i.default.MANIFEST_LOADED,{levels:g,audioTracks:y,subtitles:m,url:o,stats:t,networkDetails:n})}else d.trigger(i.default.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:o,reason:"no level found in manifest",networkDetails:n})}else d.trigger(i.default.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:o,reason:"no EXTM3U delimiter",networkDetails:n})}},{key:"loaderror",value:function(e,t){var r,n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=t.loader;switch(t.type){case"manifest":r=s.ErrorDetails.MANIFEST_LOAD_ERROR,n=!0;break;case"level":r=s.ErrorDetails.LEVEL_LOAD_ERROR,n=!1;break;case"audioTrack":r=s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,n=!1}o&&(o.abort(),this.loaders[t.type]=void 0),this.hls.trigger(i.default.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:r,fatal:n,url:o.url,loader:o,response:e,context:t,networkDetails:a})}},{key:"loadtimeout",value:function(e,t){var r,n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=t.loader;switch(t.type){case"manifest":r=s.ErrorDetails.MANIFEST_LOAD_TIMEOUT,n=!0;break;case"level":r=s.ErrorDetails.LEVEL_LOAD_TIMEOUT,n=!1;break;case"audioTrack":r=s.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT,n=!1}o&&(o.abort(),this.loaders[t.type]=void 0),this.hls.trigger(i.default.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:r,fatal:n,url:o.url,loader:o,context:t,networkDetails:a})}}]),t}(o.default);r.default=m},{2:2,28:28,29:29,30:30,42:42,46:46}],39:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=Math.pow(2,32)-1,i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,null,[{key:"init",value:function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:r,audio:n};var a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=i,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),u=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,u,o,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,a))}},{key:"box",value:function(e){for(var t,r=Array.prototype.slice.call(arguments,1),n=8,a=r.length,i=a;a--;)n+=r[a].byteLength;for((t=new Uint8Array(n))[0]=n>>24&255,t[1]=n>>16&255,t[2]=n>>8&255,t[3]=255&n,t.set(e,4),a=0,n=8;a<i;a++)t.set(r[a],n),n+=r[a].byteLength;return t}},{key:"hdlr",value:function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}},{key:"mdat",value:function(t){return e.box(e.types.mdat,t)}},{key:"mdhd",value:function(t,r){r*=t;var n=Math.floor(r/(a+1)),i=Math.floor(r%(a+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))}},{key:"mdia",value:function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))}},{key:"mfhd",value:function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"minf",value:function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))}},{key:"moof",value:function(t,r,n){return e.box(e.types.moof,e.mfhd(t),e.traf(n,r))}},{key:"moov",value:function(t){for(var r=t.length,n=[];r--;)n[r]=e.trak(t[r]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(n).concat(e.mvex(t)))}},{key:"mvex",value:function(t){for(var r=t.length,n=[];r--;)n[r]=e.trex(t[r]);return e.box.apply(null,[e.types.mvex].concat(n))}},{key:"mvhd",value:function(t,r){r*=t;var n=Math.floor(r/(a+1)),i=Math.floor(r%(a+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,o)}},{key:"sdtp",value:function(t){var r,n,a=t.samples||[],i=new Uint8Array(4+a.length);for(n=0;n<a.length;n++)r=a[n].flags,i[n+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return e.box(e.types.sdtp,i)}},{key:"stbl",value:function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))}},{key:"avc1",value:function(t){var r,n,a,i=[],o=[];for(r=0;r<t.sps.length;r++)a=(n=t.sps[r]).byteLength,i.push(a>>>8&255),i.push(255&a),i=i.concat(Array.prototype.slice.call(n));for(r=0;r<t.pps.length;r++)a=(n=t.pps[r]).byteLength,o.push(a>>>8&255),o.push(255&a),o=o.concat(Array.prototype.slice.call(n));var s=e.box(e.types.avcC,new Uint8Array([1,i[3],i[4],i[5],255,224|t.sps.length].concat(i).concat([t.pps.length]).concat(o))),u=t.width,l=t.height,f=t.pixelRatio[0],c=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,u>>8&255,255&u,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([f>>24,f>>16&255,f>>8&255,255&f,c>>24,c>>16&255,c>>8&255,255&c])))}},{key:"esds",value:function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}},{key:"mp4a",value:function(t){var r=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),e.box(e.types.esds,e.esds(t)))}},{key:"mp3",value:function(t){var r=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]))}},{key:"stsd",value:function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))}},{key:"tkhd",value:function(t){var r=t.id,n=t.duration*t.timescale,i=t.width,o=t.height,s=Math.floor(n/(a+1)),u=Math.floor(n%(a+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,u>>24,u>>16&255,u>>8&255,255&u,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,o>>8&255,255&o,0,0]))}},{key:"traf",value:function(t,r){var n=e.sdtp(t),i=t.id,o=Math.floor(r/(a+1)),s=Math.floor(r%(a+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s])),e.trun(t,n.length+16+20+8+16+8+8),n)}},{key:"trak",value:function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))}},{key:"trex",value:function(t){var r=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(t,r){var n,a,i,o,s,u,l=t.samples||[],f=l.length,c=12+16*f,d=new Uint8Array(c);for(r+=8+c,d.set([0,0,15,1,f>>>24&255,f>>>16&255,f>>>8&255,255&f,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),n=0;n<f;n++)i=(a=l[n]).duration,o=a.size,s=a.flags,u=a.cts,d.set([i>>>24&255,i>>>16&255,i>>>8&255,255&i,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,u>>>24&255,u>>>16&255,u>>>8&255,255&u],12+16*n);return e.box(e.types.trun,d)}},{key:"initSegment",value:function(t){e.types||e.init();var r,n=e.moov(t);return(r=new Uint8Array(e.FTYP.byteLength+n.byteLength)).set(e.FTYP),r.set(n,e.FTYP.byteLength),r}}]),e}();r.default=i},{}],40:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=l(e(31)),i=l(e(30)),o=e(46),s=l(e(39)),u=e(28);function l(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t,r,n,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=r,this.typeSupported=n;var i=navigator.userAgent;this.isSafari=a&&a.indexOf("Apple")>-1&&i&&!i.match("CriOS"),this.ISGenerated=!1}return n(e,[{key:"destroy",value:function(){}},{key:"resetTimeStamp",value:function(e){this._initPTS=this._initDTS=e}},{key:"resetInitSegment",value:function(){this.ISGenerated=!1}},{key:"remux",value:function(e,t,r,n,a,s,u){if(this.ISGenerated){if(u){var l=this._initPTS,f=this._PTSNormalize,c=e.inputTimeScale||t.inputTimeScale,d=1/0,h=1/0,v=e.samples;if(v.length&&(d=h=f(v[0].pts-c*a,l)),(v=t.samples).length){var p=v[0];d=Math.min(d,f(p.pts-c*a,l)),h=Math.min(h,f(p.dts-c*a,l))}if(d!==1/0){var g=l-d;Math.abs(g)>10*c&&(o.logger.warn("timestamp inconsistency, "+(g/c).toFixed(3)+"s delta against expected value: missing discontinuity ? reset initPTS/initDTS"),this._initPTS=d,this._initDTS=h,this.observer.trigger(i.default.INIT_PTS_FOUND,{initPTS:d}))}}}else this.generateIS(e,t,a);if(this.ISGenerated)if(e.samples.length){e.timescale||(o.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,a));var y=this.remuxAudio(e,a,s,u);if(t.samples.length){var m=void 0;y&&(m=y.endPTS-y.startPTS),t.timescale||(o.logger.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,a)),this.remuxVideo(t,a,s,m,u)}}else{var b=void 0;t.samples.length&&(b=this.remuxVideo(t,a,s,u)),b&&e.codec&&this.remuxEmptyAudio(e,a,s,b)}r.samples.length&&this.remuxID3(r,a),n.samples.length&&this.remuxText(n,a),this.observer.trigger(i.default.FRAG_PARSED)}},{key:"generateIS",value:function(e,t,r){var n,a,l=this.observer,f=e.samples,c=t.samples,d=this.typeSupported,h="audio/mp4",v={},p={tracks:v},g=void 0===this._initPTS;if(g&&(n=a=1/0),e.config&&f.length&&(e.timescale=e.samplerate,o.logger.log("audio sampling rate : "+e.samplerate),e.isAAC||(d.mpeg?(h="audio/mpeg",e.codec=""):d.mp3&&(e.codec="mp3")),v.audio={container:h,codec:e.codec,initSegment:!e.isAAC&&d.mpeg?new Uint8Array:s.default.initSegment([e]),metadata:{channelCount:e.channelCount}},g&&(n=a=f[0].pts-e.inputTimeScale*r)),t.sps&&t.pps&&c.length){var y=t.inputTimeScale;t.timescale=y,v.video={container:"video/mp4",codec:t.codec,initSegment:s.default.initSegment([t]),metadata:{width:t.width,height:t.height}},g&&(n=Math.min(n,c[0].pts-y*r),a=Math.min(a,c[0].dts-y*r),this.observer.trigger(i.default.INIT_PTS_FOUND,{initPTS:n}))}Object.keys(v).length?(l.trigger(i.default.FRAG_PARSING_INIT_SEGMENT,p),this.ISGenerated=!0,g&&(this._initPTS=n,this._initDTS=a)):l.trigger(i.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})}},{key:"remuxVideo",value:function(e,t,r,n,a){var l,f,c,d,h,v,p,g=8,y=e.timescale,m=e.samples,b=[],E=m.length,_=this._PTSNormalize,T=this._initDTS,A=this.nextAvcDts,S=this.isSafari;S&&(r|=m.length&&A&&(a&&Math.abs(t-A/y)<.1||Math.abs(m[0].pts-A-T)<y/5)),r||(A=t*y),m.forEach((function(e){e.pts=_(e.pts-T,A),e.dts=_(e.dts-T,A)})),m.sort((function(e,t){var r=e.dts-t.dts,n=e.pts-t.pts;return r||n||e.id-t.id}));var k=m.reduce((function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-18e3)}),0);if(k<0){o.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(k/90)+" ms to overcome this issue");for(var w=0;w<m.length;w++)m[w].dts+=k}var R=m[0];h=Math.max(R.dts,0),d=Math.max(R.pts,0);var L=Math.round((h-A)/90);r&&L&&(L>1?o.logger.log("AVC:"+L+" ms hole between fragments detected,filling it"):L<-1&&o.logger.log("AVC:"+-L+" ms overlapping between fragments detected"),h=A,m[0].dts=h,d=Math.max(d-L,A),m[0].pts=d,o.logger.log("Video/PTS/DTS adjusted: "+Math.round(d/90)+"/"+Math.round(h/90)+",delta:"+L+" ms")),R=m[m.length-1],p=Math.max(R.dts,0),v=Math.max(R.pts,0,p),S&&(l=Math.round((p-h)/(m.length-1)));for(var x=0,O=0,D=0;D<E;D++){for(var P=m[D],M=P.units,C=M.length,I=0,F=0;F<C;F++)I+=M[F].data.length;O+=I,x+=C,P.length=I,P.dts=S?h+D*l:Math.max(P.dts,h),P.pts=Math.max(P.pts,P.dts)}var N=O+4*x+8;try{f=new Uint8Array(N)}catch(e){return void this.observer.trigger(i.default.ERROR,{type:u.ErrorTypes.MUX_ERROR,details:u.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:N,reason:"fail allocating video mdat "+N})}var U=new DataView(f.buffer);U.setUint32(0,N),f.set(s.default.types.mdat,4);for(var B=0;B<E;B++){for(var j=m[B],G=j.units,H=0,z=void 0,V=0,W=G.length;V<W;V++){var K=G[V],q=K.data,X=K.data.byteLength;U.setUint32(g,X),g+=4,f.set(q,g),g+=X,H+=4+X}if(S)z=Math.max(0,l*Math.round((j.pts-j.dts)/l));else{if(B<E-1)l=m[B+1].dts-j.dts;else{var Y=this.config,$=j.dts-m[B>0?B-1:B].dts;if(Y.stretchShortVideoTrack){var J=Y.maxBufferHole,Q=Y.maxSeekHole,Z=Math.floor(Math.min(J,Q)*y),ee=(n?d+n*y:this.nextAudioPts)-j.pts;ee>Z?((l=ee-$)<0&&(l=$),o.logger.log("It is approximately "+ee/90+" ms to the next segment; using duration "+l/90+" ms for the last video frame.")):l=$}else l=$}z=Math.round(j.pts-j.dts)}b.push({size:H,duration:l,cts:z,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:j.key?2:1,isNonSync:j.key?0:1}})}this.nextAvcDts=p+l;var te=e.dropped;if(e.len=0,e.nbNalu=0,e.dropped=0,b.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var re=b[0].flags;re.dependsOn=2,re.isNonSync=0}e.samples=b,c=s.default.moof(e.sequenceNumber++,h,e),e.samples=[];var ne={data1:c,data2:f,startPTS:d/y,endPTS:(v+l)/y,startDTS:h/y,endDTS:this.nextAvcDts/y,type:"video",nb:b.length,dropped:te};return this.observer.trigger(i.default.FRAG_PARSING_DATA,ne),ne}},{key:"remuxAudio",value:function(e,t,r,n){var l,f,c,d,h,v,p,g=e.inputTimeScale,y=g/e.timescale,m=(e.isAAC?1024:1152)*y,b=this._PTSNormalize,E=this._initDTS,_=!e.isAAC&&this.typeSupported.mpeg,T=e.samples,A=[],S=this.nextAudioPts;if((r|=T.length&&S&&(n&&Math.abs(t-S/g)<.1||Math.abs(T[0].pts-S-E)<20*m))||(S=t*g),T.forEach((function(e){e.pts=e.dts=b(e.pts-E,S)})),T.sort((function(e,t){return e.pts-t.pts})),n&&e.isAAC)for(var k=0,w=S;k<T.length;){var R,L=T[k];R=L.pts-w;var x=Math.abs(1e3*R/g);if(R<=-m)o.logger.warn("Dropping 1 audio frame @ "+(w/g).toFixed(3)+"s due to "+x+" ms overlap."),T.splice(k,1),e.len-=L.unit.length;else if(R>=m&&x<1e4&&w){var O=Math.round(R/m);o.logger.warn("Injecting "+O+" audio frame @ "+(w/g).toFixed(3)+"s due to "+Math.round(1e3*R/g)+" ms gap.");for(var D=0;D<O;D++){var P=Math.max(w,0);(c=a.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(o.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),c=L.unit.subarray()),T.splice(k,0,{unit:c,pts:P,dts:P}),e.len+=c.length,w+=m,k++}L.pts=L.dts=w,w+=m,k++}else Math.abs(R),L.pts=L.dts=w,w+=m,k++}for(var M=0,C=T.length;M<C;M++){var I=T[M],F=I.unit,N=I.pts;if(void 0!==p)f.duration=Math.round((N-p)/y);else{var U=Math.round(1e3*(N-S)/g),B=0;if(r&&e.isAAC&&U){if(U>0&&U<1e4)B=Math.round((N-S)/m),o.logger.log(U+" ms hole between AAC samples detected,filling it"),B>0&&((c=a.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(c=F.subarray()),e.len+=B*c.length);else if(U<-12){o.logger.log("drop overlapping AAC sample, expected/parsed/delta:"+(S/g).toFixed(3)+"s/"+(N/g).toFixed(3)+"s/"+-U+"ms"),e.len-=F.byteLength;continue}N=S}if(v=Math.max(0,N),!(e.len>0))return;var j=_?e.len:e.len+8;l=_?0:8;try{d=new Uint8Array(j)}catch(e){return void this.observer.trigger(i.default.ERROR,{type:u.ErrorTypes.MUX_ERROR,details:u.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:j,reason:"fail allocating audio mdat "+j})}_||(new DataView(d.buffer).setUint32(0,j),d.set(s.default.types.mdat,4));for(var G=0;G<B;G++)(c=a.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(o.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),c=F.subarray()),d.set(c,l),l+=c.byteLength,f={size:c.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},A.push(f)}d.set(F,l);var H=F.byteLength;l+=H,f={size:H,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},A.push(f),p=N}var z=0,V=A.length;if(V>=2&&(z=A[V-2].duration,f.duration=z),V){this.nextAudioPts=S=p+y*z,e.len=0,e.samples=A,h=_?new Uint8Array:s.default.moof(e.sequenceNumber++,v/y,e),e.samples=[];var W=v/g,K=S/g,q={data1:h,data2:d,startPTS:W,endPTS:K,startDTS:W,endDTS:K,type:"audio",nb:V};return this.observer.trigger(i.default.FRAG_PARSING_DATA,q),q}return null}},{key:"remuxEmptyAudio",value:function(e,t,r,n){var i=e.inputTimeScale,s=i/(e.samplerate?e.samplerate:i),u=this.nextAudioPts,l=(void 0!==u?u:n.startDTS*i)+this._initDTS,f=n.endDTS*i+this._initDTS,c=1024*s,d=Math.ceil((f-l)/c),h=a.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(o.logger.warn("remux empty Audio"),h){for(var v=[],p=0;p<d;p++){var g=l+p*c;v.push({unit:h,pts:g,dts:g}),e.len+=h.length}e.samples=v,this.remuxAudio(e,t,r)}else o.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")}},{key:"remuxID3",value:function(e,t){var r,n=e.samples.length,a=e.inputTimeScale,o=this._initPTS,s=this._initDTS;if(n){for(var u=0;u<n;u++)(r=e.samples[u]).pts=(r.pts-o)/a,r.dts=(r.dts-s)/a;this.observer.trigger(i.default.FRAG_PARSING_METADATA,{samples:e.samples})}e.samples=[],t=t}},{key:"remuxText",value:function(e,t){e.samples.sort((function(e,t){return e.pts-t.pts}));var r,n=e.samples.length,a=e.inputTimeScale,o=this._initPTS;if(n){for(var s=0;s<n;s++)(r=e.samples[s]).pts=(r.pts-o)/a;this.observer.trigger(i.default.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[],t=t}},{key:"_PTSNormalize",value:function(e,t){var r;if(void 0===t)return e;for(r=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=r;return e}}]),e}();r.default=f},{28:28,30:30,31:31,39:39,46:46}],41:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(30),o=(n=i)&&n.__esModule?n:{default:n},s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t}return a(e,[{key:"destroy",value:function(){}},{key:"resetTimeStamp",value:function(){}},{key:"resetInitSegment",value:function(){}},{key:"remux",value:function(e,t,r,n,a,i,s,u){var l=this.observer,f="";e&&(f+="audio"),t&&(f+="video"),l.trigger(o.default.FRAG_PARSING_DATA,{data1:u,startPTS:a,startDTS:a,type:f,nb:1,dropped:0}),l.trigger(o.default.FRAG_PARSED)}}]),e}();r.default=s},{30:30}],42:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=/^(\d+)x(\d+)$/,i=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,o=function(){function e(t){for(var r in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"string"==typeof t&&(t=e.parseAttrList(t)),t)t.hasOwnProperty(r)&&(this[r]=t[r])}return n(e,[{key:"decimalInteger",value:function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"hexadecimalInteger",value:function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var r=new Uint8Array(t.length/2),n=0;n<t.length/2;n++)r[n]=parseInt(t.slice(2*n,2*n+2),16);return r}return null}},{key:"hexadecimalIntegerAsNumber",value:function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"decimalFloatingPoint",value:function(e){return parseFloat(this[e])}},{key:"enumeratedString",value:function(e){return this[e]}},{key:"decimalResolution",value:function(e){var t=a.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}}],[{key:"parseAttrList",value:function(e){var t,r={};for(i.lastIndex=0;null!==(t=i.exec(e));){var n=t[2];0===n.indexOf('"')&&n.lastIndexOf('"')===n.length-1&&(n=n.slice(1,-1)),r[t[1]]=n}return r}}]),e}();r.default=o},{}],43:[function(e,t,r){"use strict";t.exports={search:function(e,t){for(var r=0,n=e.length-1,a=null,i=null;r<=n;){var o=t(i=e[a=(r+n)/2|0]);if(o>0)r=a+1;else{if(!(o<0))return i;n=a-1}}return null}}},{}],44:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(45),o=(n=i)&&n.__esModule?n:{default:n},s=function(){function e(t,r,n,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hls=t,this.defaultEstimate_=a,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new o.default(r),this.fast_=new o.default(n)}return a(e,[{key:"sample",value:function(e,t){var r=8e3*t/(e=Math.max(e,this.minDelayMs_)),n=e/1e3;this.fast_.sample(n,r),this.slow_.sample(n,r)}},{key:"canEstimate",value:function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_}},{key:"getEstimate",value:function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}},{key:"destroy",value:function(){}}]),e}();r.default=s},{45:45}],45:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=0,this.totalWeight_=0}return n(e,[{key:"sample",value:function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e}},{key:"getTotalWeight",value:function(){return this.totalWeight_}},{key:"getEstimate",value:function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_}}]),e}();r.default=a},{}],46:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function a(){}var i={trace:a,debug:a,log:a,warn:a,info:a,error:a},o=i;function s(e,t){return t="["+e+"] > "+t}function u(e){var t=self.console[e];return t?function(){for(var r=arguments.length,n=Array(r),a=0;a<r;a++)n[a]=arguments[a];n[0]&&(n[0]=s(e,n[0])),t.apply(self.console,n)}:a}r.enableLogs=function(e){if(!0===e||"object"===(void 0===e?"undefined":n(e))){!function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];r.forEach((function(t){o[t]=e[t]?e[t].bind(e):u(t)}))}(e,"debug","log","info","warn","error");try{o.log()}catch(e){o=i}}else o=i},r.logger=o},{}],47:[function(e,t,r){"use strict";t.exports={toString:function(e){for(var t="",r=e.length,n=0;n<r;n++)t+="["+e.start(n).toFixed(3)+","+e.end(n).toFixed(3)+"]";return t}}},{}],48:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e(46),i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}return n(e,[{key:"destroy",value:function(){this.abort(),this.loader=null}},{key:"abort",value:function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null}},{key:"load",value:function(e,t,r){this.context=e,this.config=t,this.callbacks=r,this.stats={trequest:performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()}},{key:"loadInternal",value:function(){var e,t=this.context;e="undefined"!=typeof XDomainRequest?this.loader=new XDomainRequest:this.loader=new XMLHttpRequest;var r=this.stats;r.tfirst=0,r.loaded=0;var n=this.xhrSetup;try{if(n)try{n(e,t.url)}catch(r){e.open("GET",t.url,!0),n(e,t.url)}e.readyState||e.open("GET",t.url,!0)}catch(r){return void this.callbacks.onError({code:e.status,text:r.message},t,e)}t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()}},{key:"readystatechange",value:function(e){var t=e.currentTarget,r=t.readyState,n=this.stats,i=this.context,o=this.config;if(!n.aborted&&r>=2)if(window.clearTimeout(this.requestTimeout),0===n.tfirst&&(n.tfirst=Math.max(performance.now(),n.trequest)),4===r){var s=t.status;if(s>=200&&s<300){n.tload=Math.max(n.tfirst,performance.now());var u=void 0,l=void 0;l="arraybuffer"===i.responseType?(u=t.response).byteLength:(u=t.responseText).length,n.loaded=n.total=l;var f={url:t.responseURL,data:u};this.callbacks.onSuccess(f,n,i,t)}else n.retry>=o.maxRetry||s>=400&&s<499?(a.logger.error(s+" while loading "+i.url),this.callbacks.onError({code:s,text:t.statusText},i,t)):(a.logger.warn(s+" while loading "+i.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,o.maxRetryDelay),n.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),o.timeout)}},{key:"loadtimeout",value:function(){a.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)}},{key:"loadprogress",value:function(e){var t=e.currentTarget,r=this.stats;r.loaded=e.loaded,e.lengthComputable&&(r.total=e.total);var n=this.callbacks.onProgress;n&&n(r,this.context,null,t)}}]),e}();r.default=i},{46:46}]},{},[35])(35)}])]);
//# sourceMappingURL=vendor.9dd15f750133169b035d.js.map?brotli=allow